/* Shield UI 1.7.44 Trial Version | Copyright 2013-2022 Shield UI Ltd. | http://www.shieldui.com/eula | Expires on Tue, 13 Sep 2022 03:00:24 GMT */
!function(x,_,s,C){var e=_.ui.Widget,a=_.Class,M=_.DataSource,T=_.format,g=_.support,w=_.exp,y=_.get,r=_.iid,h=(_.strid,_.Constants.KeyCode),n=_.is,S=n.func,k=n.string,o=n.object,p=n.boolean,I=n.defined,t=n.number,B=n[void 0],q=n.null,f=_.to.int,m=document,d=Math.abs,v=Math.min,b=Math.max,O=x.each,N=x.proxy,R=x.extend,L=x.map,U=x.grep,X=x.inArray,i=navigator.userAgent,j=s.opera,Y=/msie/i.test(i)&&!j,E=Y&&7===m.documentMode,K=Y&&8===m.documentMode,Q=(Y&&m.documentMode,m.documentMode,/AppleWebKit/.test(i)),$=(/Firefox/.test(i),"role"),J="aria-sort",Z="aria-readonly",W="tabindex",ee="true",te="height",P="sui-selected",z="command",ie="selectionChanged",F="dataBound",ne="virtualRowsLoaded",re="keydown",l="mousedown",u="mousemove",oe="mouseup",H="click",le="detailCreated",ae="columnReorder",se="columnResize",de="groupsReorder",ce="ungroup",ue="editorCreating",pe="filterWidgetCreating",he="cancel",fe="edit",ge="save",_e="error",me="collapse",D="display",A="none",c="@@custom",V="row",ve="sui-viewindex",G="sui-fieldname";function be(e){var t,i=" ";if(e){if(k(e))return e;for(t in e)e.hasOwnProperty(t)&&(i+=t+'="'+e[t]+'"')}return i}function Ce(e,t){e=x(e).attr(t);return I(e)&&!1!==e}function xe(){for(var e,t,i,n=[].slice.call(arguments),r=n.shift(),o=0;o<n.length&&!(e=x(r.target).closest(".sui-cell",n[o])).length;o++);return e.length?(t=e[0].parentNode,i=e[0],null==t||null==i?null:{row:t,cell:i}):null}function Te(e){return e&&(x(e.row).hasClass(P)||x(e.cell).hasClass(P))}function we(e,t){return 0<x(e.target).closest(".sui-cell",t).length}function ye(e){e=x(e).find('.sui-checkbox:not(.sui-checkbox-disabled), .sui-radiobutton:not(.sui-radiobutton-disabled), .sui-input:not(.sui-input-disabled), .sui-combobox:not(.sui-combobox-disabled), .sui-dropdown:not(.sui-dropdown-disabled), .sui-listbox:not(.sui-listbox-disabled), .sui-switch:not(.sui-switch-disabled), a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex]:not([tabindex="-1"]), *[contenteditable]').filter(":visible").first();0<x(e).length&&x(e).focus()}var j={columns:[],rowHover:!0,scrolling:!1,paging:!1,columnReorder:!1,showHeader:!0,grouping:{showGroupHeader:!1,allowDragToGroup:!1,message:"Drag a column header here to group by a column"}},Se=a.extend({init:function(e,t){var i,n,r,o;for(this._grid=t,o=0;o<e.length;o++)r=(i=e[o]).position||"top",n=x('<div class="sui-toolbar"/>'),"top"===r?0<(r=t.element.find(".sui-toolbar")).length?x(r[0]).after(n):t.element.prepend(n):(n.addClass("sui-toolbar-bottom"),n.appendTo(t.element)),i.template?this._initializeTemplate(i,n):0<i.buttons.length&&this._buildButtons(n,i)},_buildButtons:function(e,t){for(var i=t.buttons,n=0;n<i.length;n++)this._buildButton(i[n],e)},_buildButton:function(e,t){var i=this,n=e.commandName,r=e.click;_.ui.Button&&(t=x('<button type="button">'+e.caption+"</button>").appendTo(t),"insert"==n?r=i._insertButtonClicked:"save"==n?r=i._saveButtonClicked:"cancel"==n?r=i._cancelButtonClicked:"excel"==n?r=i._excelButtonClicked:"pdf"==n?r=i._pdfButtonClicked:"csv"==n&&(r=i._csvButtonClicked),new _.ui.Button(t,{cls:e.cls,events:{click:N(r,i._grid)}}))},_excelButtonClicked:function(){this._doExcelExport()},_pdfButtonClicked:function(){this._doPdfExport()},_csvButtonClicked:function(){this._doCsvExport()},_insertButtonClicked:function(e,t){var i,n,r,o=this,l=o.options,a=l.editing.insertNewRowAt,s=o.dataSource,d=!1;if(t||!o.trigger(z,{commandName:"insert",cancel:!1}).cancel){if(s.sort&&0<s.sort.length)return s.sort=[],o._sortingInProgress=!0,o.pager&&(s.skip=0,s.take=o.pager.pageSize(),o.pager.refresh(!0)),void s.read().always(N(o._toolbar._insertButtonClicked,o,e,!0));for(r in o._editingInProcess=!0,"pagebottom"===a?(n=b(0,o.contentTable.find(">tbody > tr").length-1),l.paging&&(!o.pager||o.pager.hasNext())||(n+=1,d=!0)):n=0,(i=d?s.add({}):s.insertView(n,{})).fields)i.fields.hasOwnProperty(r)&&(i.data[r]=null);o._editing._insertedItems.push(i),t=o.contentTable.find(">tbody > tr").eq(n),"popup"!=o.options.editing.mode?o._editing._putRowInEditMode(t,0):o._initializePopupForm(0,!0),o.trigger("insert")}},_saveButtonClicked:function(e){var t=this,i=t.contentTable.find(">tbody > tr > .sui-editable-cell");0<i.length&&(i=i.get(0).parentNode.rowIndex,t._updateItem(i,null),t._errorDuringEdit)?t._errorDuringEdit=!1:t.trigger(z,{commandName:ge,cancel:!1}).cancel||(t.dataSource.save(),t.trigger(ge))},_cancelButtonClicked:function(e){this.trigger(z,{commandName:he,cancel:!1}).cancel||(this.dataSource.cancel(),this.trigger(he))},_initializeTemplate:function(e,t){var i,e=e.template;S(e)?(i=e.call(this._grid,t),I(i)&&!q(i)&&""!==i&&t.html(i)):t.html(e)},destroy:function(){}}),ke=a.extend({init:function(e,t){var i=this;i._grid=t,i.options=e,i._eventNS=".shieldGridEditing"+r(),i._editors={},i._insertedItems=[],e.enabled&&i._initEditing(),i._grid.dataSource.on(_e+i._eventNS,N(i._dsError,i))},_dsError:function(e){var t=this._editors[e.path];this._grid.trigger(_e,{type:e.type,path:e.path,value:e.value,editor:t,reason:e.reason}),this._errorDuringEdit=!0},_initEditing:function(){var e=this,t=e.options.event,i=e._eventNS;B(t)||(t===H?e._grid.element.on(H+i,".sui-cell",N(e._editingTriggered,e)):"doubleclick"===t&&e._grid.element.on("dblclick"+i,".sui-cell",N(e._editingTriggered,e)),x(m).on(H+i,N(e._documentClicked,e)))},_editingTriggered:function(e){var t,i,n=this,r=n._grid,o=e.target,l=x(o).parent(),a=l.get(0).rowIndex,s=r._getRowIndex(l),d=n.options,c=d.mode,u=d.type,p=r.dataSource,h=d.batch,f=r.trigger(z,{commandName:fe,cancel:!1,row:l,cell:o,index:s}),g=!1;if(!f.cancel){if(h){if(0<(t=r.contentTable.find(">tbody > tr > .sui-editable-cell")).length){if(a=t.get(0).parentNode.rowIndex,"TR"!==l.get(0).nodeName.toUpperCase()||l.get(0).rowIndex==a&&u==V)return;f=r._updateItem(a,o);if(n._errorDuringEdit)return n._errorDuringEdit=!1,void(f=null);i=l.get(0).rowIndex,r._putRowInViewMode(a,null),!r._populateInsertedItem&&f&&0<f.length&&r._renderUpdateMarkers(f,a),r._populateInsertedItem=!1,i===a&&(o=r.contentTable.find(">tbody > tr").eq(a).get(0).cells[o.cellIndex]),a=i}B(u)||"cell"===u?(n._putCellInEditMode(o),g=!0):u===V?(n._putRowInEditMode(l,o.cellIndex),g=!0):_.error("Invalid editing.type declaration. The editing.type must be 'row' or 'cell'.",d.dieOnError)}else if(p.tracker&&p.tracker.changes&&p.tracker.changes.added&&0<p.tracker.changes.added.length)"TR"!==l.get(0).nodeName.toUpperCase()||l.get(0).rowIndex==a&&u==V||p.cancel();else if(B(c)||"inline"===c){if(0<(t=r.contentTable.find(">tbody > tr > .sui-editable-cell")).length){if(a=t.get(0).parentNode.rowIndex,"TR"!==l.get(0).nodeName.toUpperCase()||l.get(0).rowIndex==a&&u==V)return;if(r._updateItem(a,o),n._errorDuringEdit)return void(n._errorDuringEdit=!1);i=l.get(0).rowIndex,r._closeAllEditedRows(),i===a&&(o=r.contentTable.find(">tbody > tr").eq(a).get(0).cells[o.cellIndex]),a=i}B(u)||"cell"==u?(n._putCellInEditMode(o),g=!0):u==V?(n._putRowInEditMode(l,o.cellIndex),g=!0):_.error("Invalid editing.type declaration. The editing.type must be 'row' or 'cell'.",d.dieOnError)}g&&(e.preventDefault(),e.stopPropagation(),r.trigger(fe,{row:l,cell:o,index:s}))}},_documentClicked:function(e){var t=this,i=t.options,n=i.batch,i=(i.type,i.event),r=x(e.target);t._grid._editingInProcess||t._grid._preventClosingEditors?t._grid._editingInProcess=!1:(!r.hasClass("sui-cell")&&!r.parents().hasClass("sui-cell")&&!r.parents().hasClass("sui-calendar")&&!r.parents().hasClass("sui-listbox")||"doubleclick"===i&&e.type===H&&r.closest(".sui-editable-cell").length<=0)&&0<(i=t._grid.contentTable.find(">tbody > tr > .sui-editable-cell")).length&&(e=i.get(0).parentNode.rowIndex,r=t._grid._updateItem(e,null),t._errorDuringEdit?t._errorDuringEdit=!1:(t._grid._putRowInViewMode(e,null),n&&!t._grid._populateInsertedItem&&r&&0<r.length&&t._grid._renderUpdateMarkers(r,e),t._grid._populateInsertedItem=!1))},_getColumnIndex:function(e){return e.cellIndex-x(e.parentNode).find(".sui-indent-cell, .sui-expand-cell, .sui-expand-cell-disabled, .sui-collapse-cell").length},_putCellInEditMode:function(e){var t,i=this,n=i._getColumnIndex(e),r=i._grid,o=r.dataSource,l=r._getRowIndex(x(e).parent()),r=r.columns[n],a=!1;if(r&&r.field&&!1!==r.editable)if(t=o.editView(l).data,!(1<arguments.length&&arguments[1]!=n||!(a=!0)),r.editor)i._instantiateCustomEditor(r,e,t,l,a);else{var n=I(o.schema.options.fields)?o.schema.options.fields[r.field].type:String,s=y(t,r.field);switch(n){case Number:i._instantiateNumeric(e,s,a);break;case Date:i._instantiateDatePicker(e,s,a);break;case String:i._instantiateTextBox(e,s,a);break;case Boolean:i._instantiateCheckBox(e,s,a)}}},_prepareCell:function(e){x(e).empty().addClass("sui-editable-cell")},_instantiateCustomEditor:function(e,t,i,n,r,o){var l,a=this;o?l=o:(o=a._getColumnIndex(t),l=a._grid.columns[o].field,a._prepareCell(t)),o=e.editor.call(a._grid,t,i,n,r),x(t).html(o),a._editors[l]="custom"},_instantiateNumeric:function(e,t,i,n){var r,o=this,e=(n?r=n:(n=o._getColumnIndex(e),r=o._grid.columns[n].field,o._prepareCell(e)),(n=x('<input name="'+r+'"/>')).appendTo(e),o._grid.trigger(ue,{field:r,options:{}})),e=R({},e.options,{value:t});_.ui.NumericTextBox&&(t=new _.ui.NumericTextBox(n,e),i&&t.focus(),o._editors[r]=t)},_instantiateDatePicker:function(e,t,i,n){var r,o=this,e=(n?r=n:(n=o._getColumnIndex(e),r=o._grid.columns[n].field,o._prepareCell(e)),(n=x('<input name="'+r+'"/>')).appendTo(e),o._grid.trigger(ue,{field:r,options:{}})),e=R({},e.options,{value:t});_.ui.DatePicker&&(t=new _.ui.DatePicker(n,e),i&&t.focus(),o._editors[r]=t)},_instantiateTextBox:function(e,t,i,n){var r,o=this,e=(n?r=n:(n=o._getColumnIndex(e),r=o._grid.columns[n].field,o._prepareCell(e)),(n=x('<input type="text" name="'+r+'"/>')).appendTo(e),o._grid.trigger(ue,{field:r,options:{}})),e=R({},e.options,{value:t,cls:"sui-input-textbox"});_.ui.TextBox&&(t=new _.ui.TextBox(n,e),i&&t.focus(),o._editors[r]=t)},_instantiateCheckBox:function(e,t,i,n){var r,o=this,e=(n?r=n:(n=o._getColumnIndex(e),r=o._grid.columns[n].field,o._prepareCell(e)),(n=x('<input type="checkbox" name="'+r+'"/>')).appendTo(e),o._grid.trigger(ue,{field:r,options:{}})),e=R({},e.options,{value:t});_.ui.CheckBox&&(n=new _.ui.CheckBox(n,e),i&&n.focus(),n.checked(t),o._editors[r]=n)},_putRowInEditMode:function(e,t){for(var i=e.find(".sui-cell"),n=0;n<i.length;n++)this._putCellInEditMode(i[n],t-e.find(".sui-indent-cell, .sui-expand-cell, .sui-expand-cell-disabled, .sui-collapse-cell").length);0<e.find(".sui-edit").length&&this._grid._changeEditColumnButtons(e.get(0).rowIndex,x(e.children(".sui-button-cell")[0]))},_destroyRow:function(e){for(var t,i=this._grid,e=i.contentTable.find(">tbody > tr").eq(e),n=i.columns,r=0;r<n.length;r++)(t=this._editors[n[r].field])&&(S(t.destroy)&&this._editors[n[r].field].destroy(),delete this._editors[n[r].field]);e.remove()},destroy:function(){var e,t,i=this,n=i._eventNS;if(i._grid.dataSource.off(_e+n),i._grid.element.off(n,".sui-cell"),x(m).off(H+n),i._editors)for(e=0;e<i._editors.length;e++)t=i._editors[e].editor.element(),i._editors[e].editor.destroy(),t.remove();i._errorDuringEdit=i.options=null}}),Ie=a.extend({init:function(e){var t=this;k(e)?(t.field=e,t.title=t.field,t.groupTitle=t.title,t.groupHeaderTitle=t.title,t.resizable=!0,t.sortable=!0,t.filterable=!0,t.editable=!0,t.visible=!0,t.locked=!1):o(e)&&(t.field=e.field,t.title=e.title,t.groupTitle=I(e.groupTitle)?e.groupTitle:t.title,t.groupHeaderTitle=I(e.groupHeaderTitle)?e.groupHeaderTitle:t.title,t.format=e.format,t.width=e.width,t.minWidth=e.minWidth,t.maxWidth=e.maxWidth,t.resizable=!I(e.resizable)||!!e.resizable,t.attributes=e.attributes,t.headerAttributes=e.headerAttributes,t.headerTemplate=e.headerTemplate,t.columnTemplate=e.columnTemplate,t.footerTemplate=e.footerTemplate,t.groupFooterTemplate=e.groupFooterTemplate,t.buttons=e.buttons,t.editor=e.editor,t.customFilter=e.customFilter,t.sortable=!I(e.sortable)||!!e.sortable,t.filterable=!I(e.filterable)||!!e.filterable,t.editable=!I(e.editable)||!!e.editable,t.visible=!I(e.visible)||!!e.visible,t.locked=!!t.visible&&!!e.locked)},destroy:function(){var e=this;e.field=e.buttons=e.title=e.editor=e.editable=e.format=e.width=e.minWidth=e.maxWidth=e.resizable=e.attributes=e.headerAttributes=e.headerTemplate=e.buttons=e.customFilter=e.footerTemplate=e.groupFooterTemplate=e.sortable=e.filterable=e.visible=e.locked=e.columnTemplate=null}}),Be=a.extend({options:{ns:".shieldGridColumnResizing",width:12,offset:6,min:12},init:function(e){var t=this;t.grid=e,t.options=R(!0,{},Be.fn.options),t._eventNS=t.options.ns+r(),e.headerTable.on(u+t._eventNS,".sui-headercell",N(t._showHandle,t))},_showHandle:function(e){var t,i,n,r,o;this.resizing||(i=(t=this).options,t.grid,n=t.handle,o=(r=e.pageX)>=(e=t.params=t._params(x(e.currentTarget))).offset.left&&r<=e.offset.left+i.offset&&0<e.headerIndex,(e=(o=e.isRtl?r>=e.offset.left+e.width-i.offset&&r<=e.offset.left+e.width&&0<e.headerIndex:o)?t.params=t._params(e.header.prev()):e).column&&e.column.resizable&&!e.column.locked&&(r>=e.threshold&&r<=e.edge+i.offset?(n=n||(t.handle=x('<div class="sui-resizable-handle"/>').on(l+t._eventNS,N(t._down,t)).appendTo(e.header.parents(".sui-headercontent")))).css({top:e.position.top,left:n.parent()[0].scrollLeft+e.handleLeft,width:i.width,height:e.height}).show():n&&n.hide()))},_params:function(e){var t=this.options,i=e.offset(),n=e.position(),r=g.isRtl(this.grid.element),o=e.outerWidth(),l=i.left+(r?t.width:o),a=e.index(),s=this.grid._getColumnByField(e.attr("data-field")),d=s?0<=s.minWidth?+s.minWidth:t.min:null;return{header:e,headerIndex:a,column:s,min:d,max:s&&s.maxWidth>=d?+s.maxWidth:null,offset:i,isRtl:r,width:o,current:o,height:e.outerHeight(),edge:l,threshold:l-t.width+(r?-1:1)*t.offset,position:n,handleLeft:n.left+(r?t.width:o)-t.width+(r?-1:1)*t.offset}},_down:function(e){var t,i=this,n=i.grid,r=i.params;if(!(1<e.button)&&r)return t="> colgroup col:nth-child("+(r.headerIndex+1)+")",r.origin=e.pageX,r.cols=x().add(n.headerTable.find(t)).add(n.contentTable.find(t)),i.resizing=!0,i._cancelled=null,i.handle.hide(),x(m).on(u+i._eventNS,N(i._move,i)).on(oe+i._eventNS,N(i._up,i)),_.selection(!1),!1},_move:function(e){var t,i=this,n=i.params;i.resizing&&(e=(n.isRtl?-1:1)*(e.pageX-n.origin),e=b(n.width+e,n.min),n.max&&(e=v(e,n.max)),(t=i.grid.trigger(z,{commandName:se,cancel:!1,field:n.column.field,width:e}))&&t.cancel?i._cancelled=!0:e!==n.current&&(n.cols.width(n.current=e),i.grid._fixHeaderPadding(),i.grid._adjustHeightsLocked(!0)))},_up:function(){var e=this,t=e.grid,i=e.params,n=i.current,i=i.column||{},r=(t.options.columns||[])[x(t.columns).index(i)]||{};e.resizing=!1,e.params=null,i.width=r.width=n+"px",x(m).off(e._eventNS),_.selection(!0),!0!==e._cancelled&&t.trigger(se,{field:i.field,width:n}),e._cancelled=null},destroy:function(){var e=this;e.grid.headerTable.off(e._eventNS),e._cancelled=null,e.handle&&(e.handle.off(e._eventNS).remove(),e.handle=null)}}),Ne=a.extend({init:function(e){this.grid=e,this._filters={},this._eventNS=".shieldGridFiltering"+r(),this._createFilterRow()},_createFilterRow:function(){var e,t,i,n,r,o=this,l=o.grid,a=l.headerTable.find(">thead"),s=a.find(".sui-indent-cell").length,d=l.dataSource.schema,c=l.columns;for(o._tr=e=x('<tr class="sui-filter-row"/>'),r=0;r<s;r++)x('<th class="sui-indent-cell"/>').appendTo(e);for(d&&d.options.fields&&(n=d.options.fields),r=0;r<c.length;r++)t=n&&n[c[r].field]?n[c[r].field].type:null,p=c[r].field?c[r].field.replace(/[\"\']/g,"@"):"",i=x('<th class="sui-filter-cell" data-field="'+p+'" role="gridcell" tabindex="-1"/>').appendTo(e),!1!==c[r].filterable&&0<p.length&&(o._initializeEditor(i,t,c[r].field,c[r]),o._appendFilterButton(i));for(e.appendTo(a),x(m).on(H+o._eventNS,N(o._documentClicked,o)),r=0;r<c.length;r++){var u,p=c[r].field?c[r].field.replace(/[\"\']/g,"@"):"";!1!==c[r].filterable&&0<p.length&&((u=o._getFilter(c[r].field))&&(o._setEditorValue(c[r].field,c[r],u.value),o._addRemoveFilterButton(c[r].field)))}},_documentClicked:function(e){var t,i;!this.listBox||x(e.target).hasClass("sui-filter-button")||x(e.target).hasClass("sui-filter-button-content")||(i=this.listBox.element.parent()).css(D)!=A&&(this._filterByField=null,t=i.height(),e=i.offset().top,this._slideUp?i.animate({height:0,top:e+t},150,function(){i.css({display:A,height:t})}):i.animate({height:0},150,function(){i.css({display:A,height:t})}))},_appendFilterButton:function(e){_.ui.Button&&(e=x('<button type="button"><span class="sui-sprite sui-filter-button-content"/></button>').appendTo(e),new _.ui.Button(e,{cls:"sui-filter-button",events:{click:N(this._filterButtonClicked,this)}}))},_filterButtonClicked:function(e){var t=this,i=t.grid,n=i.dataSource.schema,i=i.options.filtering,r=i.stringFunc||[{func:"eq",name:"Equal to"},{func:"neq",name:"Not equal to"},{func:"con",name:"Contains"},{func:"notcon",name:"Not contains"},{func:"starts",name:"Starts with"},{func:"ends",name:"Ends with"},{func:"gt",name:"Greater than"},{func:"lt",name:"Less than"},{func:"gte",name:"Greater than or equal"},{func:"lte",name:"Less than or equal"},{func:"isnull",name:"Is null"},{func:"notnull",name:"Is not null"}],i=i.nonStingFunc||[{func:"eq",name:"Equal to"},{func:"neq",name:"Not equal to"},{func:"gt",name:"Greater than"},{func:"lt",name:"Less than"},{func:"gte",name:"Greater than or equal"},{func:"lte",name:"Less than or equal"},{func:"isnull",name:"Is null"},{func:"notnull",name:"Is not null"}],o=e.target.element.parent().attr("data-field").replace(/[@]/g,"'");t._filterByField=o,n=!n||!n.options.fields||(n=n.options.fields)&&n[o]&&n[o].type===String?r:i,_.ui.ListBox&&(t.listBox||(t._menuWrapper=x('<div style="display:none;"/>').appendTo(m.body),t.listBox=new _.ui.ListBox(t._menuWrapper,R({},{},{dataSource:{data:n},textTemplate:"{name}",valueTemplate:"{func}",multiple:!1,width:150,maxHeight:300,events:{select:N(t._selectFilterFunction,t)}})),t.grid.element.parent().hasClass("sui-rtl")?t.listBox.element.parent().addClass("sui-rtl"):t.listBox.element.parent().css(D,A)),r=t.listBox.element.parent().height(),t._positionListBox(e),t._slideUp?(i=e.target.element.offset().top-r,t.listBox.element.parent().css({top:e.target.element.offset().top}),t.listBox.element.parent().animate({height:r,top:i-t.listBox.element.parent().innerHeight()},150)):t.listBox.element.parent().animate({height:r},150)),t._selectFilterMenuValue(o)},_getFilter:function(e){var t,i,n,r=this.grid.dataSource.filter;if(r&&r.and&&0<r.and.length)for(t=r.and,n=0;n<t.length;n++)t[n].path===e&&(i=t[n]);return i},_selectFilterMenuValue:function(e){e=this._getFilter(e),e=e?e.filter:C;e?this.listBox.values(e):this.listBox.clearSelection()},_selectFilterFunction:function(e){var t=this,i=!0,n=t._filters[t._filterByField]==c?c:t._filters[t._filterByField].value(),e=e.item.func,r={path:t._filterByField,filter:e,value:n};if(n==c&&(n=t.grid.trigger("getCustomFilterValue",{field:t._filterByField,value:null}).value,r={path:t._filterByField,filter:e,value:n}),""!==n&&null!==n||"notnull"==e||"isnull"==e){if(t.grid.dataSource.filter&&t.grid.dataSource.filter.and){for(var o=t.grid.dataSource.filter.and,l=0;l<o.length;l++)o[l].path===t._filterByField&&(o[l]=r,i=!1);i&&o.push(r)}else t.grid.dataSource.filter={and:[r]};t.grid.dataSource.read(),t._addRemoveFilterButton(t._filterByField)}},_addRemoveFilterButton:function(e){var t,i;if(_.ui.Button){for(var n,r=x(this._tr).children("th"),o=0;o<r.length;o++)if((t=x(r[o])).attr("data-field")&&t.attr("data-field").replace(/[@]/g,"'")==e){i=r[o];break}t&&0===t.find(".sui-clear-filter-button").length&&(n=x('<button type="button"><span class="sui-sprite sui-clear-filter-button-content"></span></button>').appendTo(i),new _.ui.Button(n,{cls:"sui-clear-filter-button",events:{click:N(this._clearFilterButtonClicked,this)}}))}},_clearFilterButtonClicked:function(e){for(var t,i=this,n=e.target.element.parent().attr("data-field").replace(/[@]/g,"'"),r=i.grid.dataSource.filter.and,o=0;o<r.length;o++)r[o].path==n&&r.splice(o,1);t=e.target.element,e.target.destroy(),t.remove(),i._filters[n]!=c?i._filters[n].value(null):i.grid.trigger("clearFilter",{field:n,value:null}),i.grid.dataSource.read()},_positionListBox:function(e){var t=this,e=e.target.element,i=e.offset(),n=i.top,r=i.left,o=t.listBox.element.parent().innerWidth(),l=t.listBox.element.parent().innerHeight(),a=(e.innerWidth(),e.innerHeight());(r=r<0?1:r)+o>s.innerWidth&&(r=s.innerWidth-o-20),t._slideUp=!1,n+l>s.innerHeight&&(n-=l,t._slideUp=!(a=0)),n<0&&(n=i.top,a=e.innerHeight(),t._slideUp=!1),t.listBox.element.parent().css({position:"absolute",zIndex:10002,top:n+a,left:r,height:0,display:""})},_setEditorValue:function(e,t,i){t.customFilter||(t=this._filters[e])&&t.value(i)},_initializeEditor:function(e,t,i,n){var r=this;if(n.customFilter)r._filters[i]=c,n.customFilter.call(r.grid,e);else switch(t){case Number:r._instantiateNumeric(e,i);break;case Date:r._instantiateDatePicker(e,i);break;default:String;r._instantiateTextBox(e,i)}},_instantiateNumeric:function(e,t){var e=x("<input/>").appendTo(e),i=this.grid.trigger(pe,{field:t,options:{}}),i=R({},i.options);_.ui.NumericTextBox&&(e=new _.ui.NumericTextBox(e,i),this._filters[t]=e)},_instantiateDatePicker:function(e,t){var e=x("<input/>").appendTo(e),i=this.grid.trigger(pe,{field:t,options:{}}),i=R({},i.options);_.ui.DatePicker&&(e=new _.ui.DatePicker(e,i),this._filters[t]=e)},_instantiateTextBox:function(e,t){var e=x('<input type="text"/>').appendTo(e),i=this.grid.trigger(pe,{field:t,options:{}}),i=R({},i.options);_.ui.TextBox&&(e=new _.ui.TextBox(e,i),this._filters[t]=e)},destroy:function(){var e,t=this;for(e in t._filters)t._filters.hasOwnProperty(e)&&(t._filters[e]!=c&&t._filters[e].destroy(),t._filters[e]=null);t.listBox&&(t.listBox.destroy(),t.listBox=null),x(t._menuWrapper).remove(),x(t._tr).remove(),x(m).off(H+t._eventNS),t._filterByField=t._filters=t._slideUp=t._menuWrapper=t._tr=null}}),Re=a.extend({init:function(e,t){var i=this;i.grid=t,i.sortExpressions=[],i._eventNS=".shieldGridSorting"+r(),p(e)?(i.allowUnsort=!0,i.multiple=!1,i.firstAscending=!0,i.ascText="&#9650;",i.descText="&#9660;"):o(e)&&(i.allowUnsort=!!B(e.allowUnsort)||e.allowUnsort,i.multiple=e.multiple,i.firstAscending=!!B(e.firstAscending)||e.firstAscending,i.ascText=B(e.ascText)?"&#9650;":e.ascText,i.descText=B(e.descText)?"&#9660;":e.descText),i._initialize()},destroy:function(){var e=this,t=e.grid.headerTable;e.allowUnsort=e.multiple=e.sortExpressions=null,e.length=0,t.find(".sui-headercell .sui-link").each(function(){x(this).parent().html(x(this).html())}),t.off(e._eventNS),t.find('.sui-headercell span[class^="sui-"]').remove()},_initialize:function(){var e,t,i,n,r,o,l,a,s=this,d=s.grid,c=d.dataSource.sort,u=d.columns,p={};if(d.headerTable.find(".sui-headercell").each(function(){var e=x(this),t=e.attr("data-field"),i=d._getColumnByField(t);p[t]=e,i&&!1!==i.sortable&&(t=e.html(),e.empty(),e.removeAttr(J),x('<a href="#" class="sui-link sui-unselectable" unselectable="on" tabindex="-1"/>').appendTo(e).html(t))}),d.headerTable.on(H+s._eventNS,".sui-link",N(s._clickHandler,s)),c)for(e=0;e<c.length;e++)for(i=c[e],t=0;t<u.length;t++)!1!==u[t].sortable&&i.path==u[t].field&&(r=(n=x(p[u[t].field])).find(".sui-link"),o="ascending",l="sui-asc",a=s.ascText,i.desc&&(o="descending",a=s.descText,l="sui-desc"),x(n).attr(J,o),r.addClass(l),x('<span class="sui-'+o+'">'+a+"</span>").appendTo(r))},_clickHandler:function(e){var t=this,e=x(e.target).closest(".sui-link"),i=t.grid._getColumnByField(e.parent().attr("data-field"));return e.hasClass("sui-desc")?t.allowUnsort&&t.firstAscending?t._sortInternal(i,!0,!0):t._sortInternal(i,!1,!1):e.hasClass("sui-asc")?t.allowUnsort&&!t.firstAscending?t._sortInternal(i,!1,!0):t._sortInternal(i,!0,!1):t.firstAscending?t._sortInternal(i,!1,!1):t._sortInternal(i,!0,!1),!1},_sortInternal:function(t,i,n){var e,r=this.grid,o=r.dataSource,l=o.sort;r.trigger(z,{commandName:"sort",cancel:!1,column:t,desc:i,unsort:n}).cancel||(l?(!this.multiple&&l?l.length=0:0<(e=U(l,function(e){return e.path===t.field&&e.desc===(n?i:!i)})).length&&(e=X(e[0],l),l.splice(e,1)),n||l.push({path:t.field,desc:i})):n||(l=o.sort=[{path:t.field,desc:i}]),r._refreshOnSort(),r.trigger("sort",{column:t,desc:i,unsort:n}))},_sort:function(t,i,e){var n,r,o,l,a=this.grid,s=a.dataSource,d=s.sort;!(n=d?U(d,function(e){return e.path===t&&e.desc===i}):n)||n.length<=0?(!this.multiple&&d&&(d.length=0),d?(o=!1,(l=U(d,function(e){return e.path===t&&e.desc!=i}))&&0<l.length&&(r=X(l[0],d),d.splice(r,1),o=!0),e||(d.push({path:t,desc:i}),o=!0),o&&a._refreshOnSort()):e||(s.sort=[{path:t,desc:i}],a._refreshOnSort())):e&&(r=X(n[0],d),d.splice(r,1),a._refreshOnSort())}}),Ee=a.extend({init:function(e,t){var i=this,n=i._eventNS=".shieldGridSelection"+r();p(e)?(i.type=V,i.multiple=!1,i.toggle=!1,i.spreadsheet=!0,i.drawArea=!1,i.disableTextSelection=!1,i._selectOnMouseDown=!1):o(e)&&(i.type=e.type||V,i.multiple=!!e.multiple,i.toggle=!!I(e.toggle)&&e.toggle,i.spreadsheet=!I(e.spreadsheet)||e.spreadsheet,i.drawArea=I(e.drawArea)?e.drawArea:e.multiple,i.disableTextSelection=!!I(e.disableTextSelection)&&e.disableTextSelection,i._selectOnMouseDown=!i.drawArea&&e.selectEvent==l),i.grid=t,i.lastSelected=null,x(t.headerTable).add(t.frozenHeaderTable).addClass("sui-non-selectable"),x(t.contentTable).add(t.frozenContentTable).addClass("sui-selectable"),x(t.contentTable).add(t.frozenContentTable).on(l+n,N(i._mouseDownHandler,i)).on(u+n,N(i._mouseMoveHandler,i)),x(m).on(oe+n,N(i._mouseUpHandler,i)),Y&&x(t.contentTable).add(t.frozenContentTable).on("selectstart"+n,function(){return!1}),i.multiple&&i.drawArea&&(i.area=x(m.createElement("span")).addClass("sui-area sui-area-color"))},destroy:function(){var e=this,t=e._eventNS,i=e.grid;x(i.contentTable).add(i.frozenContentTable).off(t),x(m).off(t),e.area&&e.area.remove(),e.type=e.multiple=e.lastSelected=e.toggle=e.spreadsheet=e.area=e.x=e.y=e.elements=null},select:function(e){var t,i,n,r;if(!e)return this.grid.contentTable.find("."+P);if(0<(i=(t=x(e)).length))for(r=0;r<i;r++)n=x(t.get(r)),this._selectElement(n),r==i-1&&(this.lastSelected=n)},clear:function(){this.type==V?this._clearSelectedRows():this._clearSelectedCells()},_getParentTable:function(e){if(e)return"TABLE"==e[0].nodeName.toUpperCase()?e[0]:e.parent()?this._getParentTable(e.parent()):void 0},_mouseDownHandler:function(e){var t=this,i=t.grid,n=e.pageX,r=e.pageY,o=x(e.target),l=t._getParentTable(o);t.x=n,t.y=r,"TD"==o[0].nodeName.toUpperCase()&&l!=x(i.contentTable)[0]&&l!=x(i.frozenContentTable)[0]||!(o.hasClass("sui-cell")||o.hasClass("sui-row")||o.hasClass("sui-alt-row")||we(e,i.contentTable)||we(e,i.frozenContentTable))||o.hasClass("sui-detail-cell")||o.hasClass("sui-detail-row")||o.hasClass("sui-collapse-cell")||o.hasClass("sui-expand-cell")||o.hasClass("sui-expand-cell-disabled")||o.hasClass("sui-indent-cell")||(t.multiple&&t.drawArea&&t.area.appendTo(m.body).css({left:n+1,top:r+1,width:0,height:0}),x(m).on(u+t._eventNS,N(t._mouseMoveHandler,t)),(t.drawArea||t.disableTextSelection)&&_.selection(!1),t.elements=xe(e,i.contentTable,i.frozenContentTable),t.elements&&t._selectOnMouseDown&&!Te(t.elements)&&t._performAndProcessSelection(e))},_mouseMoveHandler:function(e){var t=this,i=e.pageX,e=e.pageY,n=t.x,r=t.y,n={left:i<n?i:n,top:e<r?e:r,width:d(i-t.x),height:d(e-t.y)};t.multiple&&t.drawArea&&t.area.css(n)},_mouseUpHandler:function(e){var t=this,i=t.area;x(m).off(u+t._eventNS),(t.drawArea||t.disableTextSelection)&&_.selection(!0),!t.elements||t._selectOnMouseDown&&!Te(t.elements)||t._performAndProcessSelection(e),i&&i.remove()},_performAndProcessSelection:function(e){var t,i,n=this,r=n.grid,o=n.area,l=n.elements,a=e.ctrlKey,s=[],d=[],c=[],u=r.trigger(z,{commandName:"selectionChanging",cancel:!1});if(u.cancel)n.elements=null;else{for(n.elementsToBeSelected=[],n.type==V?n._performRowSelection(o,a,l,e):n._performCellSelection(o,a,l,e),i=0;i<n.elementsToBeSelected.length;i++)!((t=n.elementsToBeSelected[i]).hasClass("sui-cell")||t.hasClass("sui-row")||t.hasClass("sui-alt-row"))||t.hasClass("sui-detail-cell")||t.hasClass("sui-detail-row")||t.hasClass("sui-collapse-cell")||t.hasClass("sui-expand-cell")||t.hasClass("sui-expand-cell-disabled")||t.hasClass("sui-indent-cell")||(s.push(t),t=r._getRowIndex(n.type==V?t:x(t).parent()),d.push(t),c.push(0<=t?r.dataSource.getDataIndex(t):t));if(!r.trigger(z,{commandName:ie,cancel:!1,toBeSelected:s,viewIndices:d,indices:c}).cancel){for(i=0;i<s.length;i++)n._selectElement(s[i]);r.trigger(ie,{selected:s,viewIndices:d,indices:c}),n.elements=null}}},_performRowSelection:function(e,t,i,n){var r,o=this;x(n.target).hasClass("sui-expand-cell")||x(n.target).hasClass("sui-expand-cell-disabled")||x(n.target).hasClass("sui-collapse-cell")||x(n.target)&&x(n.target).parent()&&(x(n.target).parent().hasClass("sui-expand-cell")||x(n.target).parent().hasClass("sui-expand-cell-disabled")||x(n.target).parent().hasClass("sui-collapse-cell"))||(!o.drawArea||n.type===re||e&&0===e.height()&&0===e.width()?o.multiple?o._processMultiRowSelection(n,i):o._processSingleRowSelection(n,i):o.multiple?(e=o.grid.contentTable.find(">tbody > tr"),r=null,O(e,function(e,t){x(t).offset().top<n.pageY&&(r=t.rowIndex)}),t||o._clearSelectedRows(),o._selectRowRange(i.row.rowIndex,r,t)):o._processSingleRowSelection(n,i))},_performCellSelection:function(e,t,i,p){var h=this;if(!(x(p.target).hasClass("sui-expand-cell")||x(p.target).hasClass("sui-expand-cell-disabled")||x(p.target).hasClass("sui-collapse-cell")||x(p.target)&&x(p.target).parent()&&(x(p.target).parent().hasClass("sui-expand-cell")||x(p.target).parent().hasClass("sui-expand-cell-disabled")||x(p.target).parent().hasClass("sui-collapse-cell"))))if(!h.drawArea||p.type===re||e&&0===e.height()&&0===e.width())h.multiple?h._processMultiCellSelection(p,i):h._processSingleCellSelection(p,i);else if(h.multiple){var n,e=h.grid.contentTable.find(">tbody > tr > td"),f=[];for(O(e,function(e,t){var i=x(t),n=i.get(0).clientWidth,r=i.get(0).clientHeight,o=i.offset().top,i=i.offset().left,r=o+r,n=i+n,l=v(p.pageX,h.x),a=b(p.pageX,h.x),s=v(p.pageY,h.y),d=b(p.pageY,h.y),c=!1,u=!1;o<s?s<r&&(c=!0):o<d&&(c=!0),i<l?l<n&&(u=!0):i<a&&(u=!0),c&&u&&f.push(t)}),t||h._clearSelectedCells(),n=0;n<f.length;n++)x(f[n]).hasClass(P)?h._deselectElement(x(f[n])):h.elementsToBeSelected.push(x(f[n]))}else h._processSingleCellSelection(p,i)},_selectRowRange:function(e,t,i){for(var n,r=v(e,t),o=b(e,t),l=this.grid.contentTable.find(">tbody > tr"),a=r;a<=o;a++)n=x(l[a]),i&&n.hasClass(P)?this._deselectElement(n):this.elementsToBeSelected.push(n)},_clearSelectedRows:function(){var e=this,t=e.grid;x(t.frozenContentTable).find("> tbody > tr."+P).each(function(){e._deselectElement(x(this))}),x(t.contentTable).find("> tbody > tr."+P).each(function(){e._deselectElement(x(this))})},_clearSelectedCells:function(){var e=this,t=e.grid;x(t.frozenContentTable).find(">tbody > tr > td."+P).each(function(){e._deselectElement(x(this))}),x(t.contentTable).find(">tbody > tr > td."+P).each(function(){e._deselectElement(x(this))})},_processSingleRowSelection:function(e,t){var i=this,n=i.toggle,r=i.multiple,t=x(t.row),o=t.hasClass(P);r||i._clearSelectedRows(),n?o?i._deselectElement(t):i.elementsToBeSelected.push(t):(i._clearSelectedRows(),i.elementsToBeSelected.push(t)),i.lastSelected=t},_processMultiRowSelection:function(e,t){var i=this,n=i.grid,r=e.ctrlKey,o=e.shiftKey,l=x(t.row);if(r)l.hasClass(P)?i._deselectElement(l):i.elementsToBeSelected.push(l),i.lastSelected=l;else if(o){n.contentTable.find(">tbody > tr."+P);if(i.lastSelected){var a=i.lastSelected.get(0).rowIndex,s=n.contentTable.find(">tbody > tr"),r=l.get(0).rowIndex,o=v(r,a),d=b(r,a);i._clearSelectedRows();for(var c,u=o;u<=d;u++)u!==a&&(c=x(s[u]),i.elementsToBeSelected.push(c));i.elementsToBeSelected.push(x(s[a]))}else i.elementsToBeSelected.push(l),i.lastSelected=l}else i._processSingleRowSelection(e,t)},_processSingleCellSelection:function(e,t){var i=this,n=i.toggle,r=i.multiple,t=x(t.cell),o=t.hasClass(P);i.lastSelected;r||i._clearSelectedCells(),n?o?i._deselectElement(t):i.elementsToBeSelected.push(t):(i._clearSelectedCells(),i.elementsToBeSelected.push(t)),i.lastSelected=t},_processMultiCellSelection:function(e,t){var i=this,n=i.grid,r=e.ctrlKey,o=e.shiftKey,l=x(t.cell);if(r)l.hasClass(P)?i._deselectElement(l):i.elementsToBeSelected.push(l),i.lastSelected=l;else if(o)if(i.lastSelected){var a,r=i.lastSelected,s=n.contentTable.get(0),o=s.rows[0].cells.length,d=r.parent().get(0).rowIndex,c=d*o+r.get(0).cellIndex,u=n.contentTable.find(">tbody > tr > td"),n=l.parent().get(0).rowIndex,o=n*o+l.get(0).cellIndex,p=v(o,c),h=b(o,c);if(i._clearSelectedCells(),i.spreadsheet)for(var o=r[0].cellIndex,r=l[0].cellIndex,p=v(o,r),h=b(o,r),o=v(d,n),f=b(d,n),g=o;g<=f;g++)for(var _=s.rows[g],m=p;m<=h;m++)i.elementsToBeSelected.push(x(_.cells[m]));else for(g=p;g<=h;g++)g!==c&&(a=x(u[g]),i.elementsToBeSelected.push(a));i.elementsToBeSelected.push(x(u[c]))}else i.elementsToBeSelected.push(l),i.lastSelected=l;else i._processSingleCellSelection(e,t)},_selectElement:function(e){x(e).add(this.type==V?this.grid._getOtherRow(e):null).addClass(P)},_deselectElement:function(e){x(e).add(this.type==V?this.grid._getOtherRow(e):null).removeClass(P)}}),We=a.extend({options:{ns:".shieldGridGroupReorder",returnDuration:50,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div style='border-color:transparent;' class='sui-grid sui-grid-core'><div class='sui-group-panel-indicator'><span class='sui-group-title'>{0}</span><span class='sui-group-close-button'></span></div></div>"},init:function(e){var t=this;t.grid=e,t.options=R(!0,{},We.fn.options),t._eventNS=t.options.ns+r(),t._events(!0)},_events:function(e){var t=this,i=t.grid.element;e?(t._downProxy=N(t._down,t),i.on(l+t._eventNS,".sui-group-panel-indicator",t._downProxy)):(i.off(l+t._eventNS,".sui-group-panel-indicator",t._downProxy),t._downProxy=null)},_down:function(e){var t=this,i=x(e.target).closest(".sui-group-panel-indicator"),n=i.offset(),r=t.grid.element,o=r.offset(),l=e.pageX,a=e.pageY;if(t.dataField=i.attr("data-field"),!(1<e.button))return t._moveProxy=N(t._move,t),t._upProxy=N(t._up,t),x(m).on(u+t._eventNS,t._moveProxy).on(oe+t._eventNS,t._upProxy),t.start={left:l-n.left,top:a-n.top,x:l,y:a,target:i,index:i.parent().find(".sui-group-panel-indicator").index(i),positions:t._positions(i),gridPosition:{left:o.left,top:o.top,width:r.outerWidth(),height:r.outerHeight()},isRtl:g.isRtl(r)},_.selection(!1),!1},_move:function(e){var t=this,i=t.options,n=t.dragged,r=t.start,o=e.pageX,e=e.pageY,l=i.dragTreshold;n?(n.css({left:o-r.left,top:e-r.top}),t.hovered=t._index(o,e),t._indicator()):(d(r.x-o)>l||d(r.y-e)>l)&&(t.dragged=x(T(i.draggedTemplate,r.target.html())).css({position:"absolute",left:o-r.left,top:e-r.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",r.target[0].style.cssText).css({width:r.target.width(),height:r.target.height()}).end().appendTo(m.body))},_positions:function(e){for(var t,i,n=e.parent().children(".sui-group-panel-indicator"),r=0,o=[];r<n.length;r++)i=(t=n.eq(r)).offset(),o.push({left:i.left,top:i.top,width:t.outerWidth(),height:t.outerHeight()});return o},_index:function(e,t){for(var i,n,r=this.start,o=r.gridPosition,l=0;l<r.positions.length;l++)if(i=(i=r.positions[l]).left<=e&&e<=i.left+i.width&&i.top<=t&&t<=i.top+i.height,n=o.left<=e&&e<=o.left+o.width&&o.top<=t&&t<=o.top+o.height,i&&n)return l;return-1},_indicator:function(){var e=this.start,t=this.hovered,i=e.positions[t],n=this.reorderIndicator,r=e.gridPosition.left,o=e.gridPosition.left+e.gridPosition.width,l=e.target.parent().children(".sui-group-panel-indicator"),a=e.isRtl?e.index<t:e.index>t;l.removeClass("sui-reorder-target"),n&&n.hide(),null!=t&&-1<t&&(l.eq(t).addClass("sui-reorder-target"),n=n||(this.reorderIndicator=x("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(m.body)),t!==e.index&&(l=i.left+(a?0:i.width),n.css({left:v(b(r,l),o),top:i.top,height:i.height}).show()))},_up:function(e){var t,i=this,n=i.options,r=i.grid,o=i.dragged,l=i.start,a=i.hovered,s=i.dataField;if(i._detachDocumentEvents(),o)if(null!=a&&-1<a){if(o.remove(),!(t=r.trigger(z,{commandName:de,cancel:!1,index:l.index,newIndex:a})).cancel)for(var d=r.dataSource.group,c=0;c<d.length;c++)if(d[c].field==s){var u=d[c];d[c]=d[a],d[a]=u;break}}else setTimeout(function(){o.remove()},g.transitions?n.returnDuration:0),!i.grid.dataSource.group||(t=r.trigger(z,{commandName:ce,cancel:!1,field:s})).cancel||(i.grid.ungroup(s),r.trigger(ce,t));i.dragged=i.dataField=i.hovered=a=null,i._indicator(),i.reorderIndicator&&(i.reorderIndicator.remove(),i.reorderIndicator=null),i.start=null,x(m).off(i._eventNS),_.selection(!0),t&&!t.cancel&&(delete t.cancel,delete t.commandName,r.dataSource.read(),r.trigger(de,t))},_detachDocumentEvents:function(){this._moveProxy=this._upProxy=null,x(m).off(this._eventNS)},destroy:function(){this.dataField=null,this._detachDocumentEvents(),this._events(!1)}}),Pe=a.extend({options:{ns:".shieldGridColumnGroupReorder",returnDuration:150,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div class='sui-grid sui-grid-core'><div class='sui-gridheader'><table class='sui-table'><thead><tr class='sui-columnheader'><th class='sui-headercell'>{0}</th></tr></thead></table></div></div>"},init:function(e){var t=this;t.grid=e,t.options=R(!0,{},ze.fn.options),t._eventNS=t.options.ns+r(),t._events(!0),e.headerTable.addClass("sui-reorderable")},_events:function(e){var t=this,i=t.grid.element;e?(t._downProxy=N(t._down,t),i.on(l+t._eventNS,".sui-headercell",t._downProxy)):(i.off(l+t._eventNS,".sui-headercell",t._downProxy),t._downProxy=null)},_down:function(e){var t=this,i=x(e.target).closest(".sui-headercell"),n=i.offset(),r=t.grid.element,o=r.offset(),l=e.pageX,a=e.pageY;if(!(1<e.button)){var s=i.attr("data-field"),d=t.grid.dataSource.group;if(d)for(var c=0;c<d.length;c++)if(s===d[c].field)return;return x(m).on(u+t._eventNS,N(t._move,t)).on(oe+t._eventNS,N(t._up,t)),t.start={left:l-n.left,top:a-n.top,x:l,y:a,target:i,index:1e3,positions:t._positions(i),gridPosition:{left:o.left,top:o.top,width:r.outerWidth(),height:r.outerHeight()},isRtl:g.isRtl(r)},_.selection(!1),!1}},_move:function(e){var t=this,i=t.options,n=t.dragged,r=t.start,o=e.pageX,e=e.pageY,l=i.dragTreshold;n?(n.css({left:o-r.left,top:e-r.top}),t.hovered=t._index(o,e),t._indicator()):(d(r.x-o)>l||d(r.y-e)>l)&&(t.dragged=x(T(i.draggedTemplate,r.target.html())).css({position:"absolute",left:o-r.left,top:e-r.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",r.target[0].style.cssText).css({width:r.target.width(),height:r.target.height()}).end().appendTo(m.body))},_positions:function(e){for(var t,i,n=this.grid.element.find(".sui-group-panel-indicator"),r=0,o=[];r<n.length;r++)i=(t=n.eq(r)).offset(),o.push({left:i.left,top:i.top,width:t.outerWidth(),height:t.outerHeight()}),r==n.length-1&&o.push({left:i.left,top:i.top,width:t.outerWidth(),height:t.outerHeight()});return o},_index:function(e,t){var i,n,r,o,l=this.start,a=l.gridPosition,s=this.grid.element.find(".sui-group-panel");if(0<l.positions.length){for(i=0;i<l.positions.length;i++)if(n=(n=l.positions[i]).left<=e&&e<=n.left+n.width&&n.top<=t&&t<=n.top+n.height,o=a.left<=e&&e<=a.left+a.width&&a.top<=t&&t<=a.top+a.height,r=s.offset().left<=e&&e<=s.offset().left+s.width()&&s.offset().top<=t&&t<=s.offset().top+s.height(),n&&o)return i}else r=s.offset().left<=e&&e<=s.offset().left+s.width()&&s.offset().top<=t&&t<=s.offset().top+s.height();return r?(this.isOnGroupPanel=!0,this.grid.element.find(".sui-group-panel-indicator").length):-1},_indicator:function(){var e,t=this,i=t.start,n=t.hovered,r=i.positions[n],o=t.reorderIndicator,l=i.gridPosition.left,a=i.gridPosition.left+i.gridPosition.width,s=i.target.parent().children(".sui-group-panel-indicator"),d=i.isRtl?i.index<n:i.index>n;s.removeClass("sui-reorder-target"),o&&o.hide(),null!=n&&-1<n&&(s.eq(n).addClass("sui-reorder-target"),o=o||(t.reorderIndicator=x("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(m.body)),this.isOnGroupPanel&&(d=!1),r?(e=r.left+(d?0:r.width),this.isOnGroupPanel=null,o.css({left:v(b(l,e),a),top:r.top,height:r.height}).show()):(e=l+(d?i.gridPosition.width:0),this.isOnGroupPanel=null,o.css({left:e,top:i.gridPosition.top,height:t.grid.element.find(".sui-group-panel-empty").outerHeight()}).show()))},_up:function(e){var t,i=this,n=i.options,r=i.grid,o=i.dragged,l=i.start,a=i.hovered;o&&(o.css({left:l.x-l.left,top:l.y-l.top,transition:T("left {0} {1}ms, top {0} {1}ms",n.returnEasing,n.returnDuration)}),null!=a&&-1<a?(o.remove(),l=l.target.attr("data-field"),(t=r.trigger(z,{commandName:"group",cancel:!1,field:l,index:a})).cancel||r.group(l,a,"asc")):setTimeout(function(){o.remove()},g.transitions?n.returnDuration:0)),i.dragged=i.hovered=a=null,i._indicator(),i.reorderIndicator&&(i.reorderIndicator.remove(),i.reorderIndicator=null),i.start=null,x(m).off(i._eventNS),_.selection(!0),t&&!t.cancel&&(delete t.cancel,delete t.commandName,r.dataSource.read(),r.trigger("group",t))},destroy:function(){this._events(!1),this.grid.headerTable.removeClass("sui-reorderable")}}),ze=a.extend({options:{ns:".shieldGridColumnReorder",returnDuration:150,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div class='sui-grid sui-grid-core'><div class='sui-gridheader'><table class='sui-table'><thead><tr class='sui-columnheader'><th class='sui-headercell'>{0}</th></tr></thead></table></div></div>"},init:function(e){var t=this;t.grid=e,t.options=R(!0,{},ze.fn.options),t._eventNS=t.options.ns+r(),t._events(!0),e.headerTable.addClass("sui-reorderable")},_events:function(e){var t=this,i=t.grid.element;e?(t._downProxy=N(t._down,t),i.on(l+t._eventNS,".sui-headercell",t._downProxy)):(i.off(l+t._eventNS,".sui-headercell",t._downProxy),t._downProxy=null)},_down:function(e){var t=this,i=x(e.target).closest(".sui-headercell"),n=i.offset(),r=t.grid.element,o=r.offset(),l=e.pageX,a=e.pageY;if(!(1<e.button))return x(m).on(u+t._eventNS,N(t._move,t)).on(oe+t._eventNS,N(t._up,t)),t.start={left:l-n.left,top:a-n.top,x:l,y:a,target:i,index:i.parent().find(".sui-headercell").index(i),positions:t._positions(i),gridPosition:{left:o.left,top:o.top,width:r.outerWidth(),height:r.outerHeight()},isRtl:g.isRtl(r)},_.selection(!1),!1},_move:function(e){var t=this,i=t.options,n=t.dragged,r=t.start,o=e.pageX,e=e.pageY,l=i.dragTreshold;n?(n.css({left:o-r.left,top:e-r.top}),t.hovered=t._index(o,e),t._indicator()):(d(r.x-o)>l||d(r.y-e)>l)&&(t.dragged=x(T(i.draggedTemplate,r.target.html())).css({position:"absolute",left:o-r.left,top:e-r.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",r.target[0].style.cssText).css({width:r.target.width(),height:r.target.height()}).end().appendTo(m.body))},_positions:function(e){for(var t,i,n=e.parent().children(".sui-headercell"),r=0,o=[];r<n.length;r++)i=(t=n.eq(r)).offset(),o.push({left:i.left,top:i.top,width:t.outerWidth(),height:t.outerHeight()});return o},_index:function(e,t){for(var i,n,r=this.start,o=r.gridPosition,l=0;l<r.positions.length;l++)if(i=(i=r.positions[l]).left<=e&&e<=i.left+i.width&&i.top<=t&&t<=i.top+i.height,n=o.left<=e&&e<=o.left+o.width&&o.top<=t&&t<=o.top+o.height,i&&n)return l;return-1},_indicator:function(){var e=this.start,t=this.hovered,i=e.positions[t],n=this.reorderIndicator,r=e.gridPosition.left,o=e.gridPosition.left+e.gridPosition.width,l=e.target.parent().children(".sui-headercell"),a=e.isRtl?e.index<t:e.index>t;l.removeClass("sui-reorder-target"),n&&n.hide(),null!=t&&-1<t&&(l.eq(t).addClass("sui-reorder-target"),n=n||(this.reorderIndicator=x("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(m.body)),t!==e.index&&(l=i.left+(a?0:i.width),n.css({left:v(b(r,l),o),top:i.top,height:i.height}).show()))},_up:function(e){var t,i=this,n=i.options,r=i.grid,o=i.dragged,l=i.start,a=i.hovered;o&&(o.css({left:l.x-l.left,top:l.y-l.top,transition:T("left {0} {1}ms, top {0} {1}ms",n.returnEasing,n.returnDuration)}),null!=a&&-1<a?(o.remove(),(t=r.trigger(z,{commandName:ae,cancel:!1,index:l.index,newIndex:a})).cancel||r.reorderColumn(l.index,a)):setTimeout(function(){o.remove()},g.transitions?n.returnDuration:0)),i.dragged=i.hovered=a=null,i._indicator(),i.reorderIndicator&&(i.reorderIndicator.remove(),i.reorderIndicator=null),i.start=null,x(m).off(i._eventNS),_.selection(!0),t&&!t.cancel&&(delete t.cancel,delete t.commandName,r.trigger(ae,t))},destroy:function(){this._events(!1),this.grid.headerTable.removeClass("sui-reorderable")}}),i=e.extend({init:function(){e.fn.init.apply(this,arguments);this._eventNS=".shieldGrid"+this.getInstanceId(),this.refresh(),this._dM()},destroy:function(){this._destroyInternal(),e.fn.destroy.call(this)},_destroyInternal:function(){var e,t,i,n=this,r=n.options,o=n._eventNS;if(n.contentWrapper){if(n._markedCells){for(t in n._markedCells)n._markedCells.hasOwnProperty(t)&&(n._markedCells[t].length=0);n._markedCells=null}if(x(s).off(o),n._destroyFrozenContainers(),n.sorting&&(n.sorting.destroy(),n.sorting=null),n.virtualizedContainer&&(n.virtualizedContainer.destroy(),n.virtualizedContainer=null),n.columns)for(e=0;e<n.columns.length;e++)n.columns[e].destroy();if(n.contentWrapper&&n.contentWrapper.off("scroll"),n.scrollableWrapper=null,n._selectable&&(n._selectable.destroy(),n._selectable=null),r.scrolling?(n.contentWrapper.parent().remove(),n.headerWrapper.parent().remove()):(n.contentWrapper.remove(),n.headerWrapper.remove()),n._hasDetailTemplate()&&n.contentTable.off(o),n.popupWindow&&n.popupWindow.destroy(),n._footer&&(x(n._footer).remove(),n._footer=null),n.columns=n._gridColumns=n._windowEditingIndex=n.contentWrapper=n.headerWrapper=n.contentTable=n.hederTable=null,n._buttons){for(e=0;e<n._buttons.length;e++)i=n._buttons[e].button.element,n._buttons[e].button.destroy(),i.remove();n._buttons.length=0}n.pager&&(n.pager.destroy(),n.pager=null,n.pagerWrapper&&(n.pagerWrapper.parent().remove(),n.pagerWrapper=null)),n.loadingPanel&&(n.loadingPanel=null,clearTimeout(n.loadingPanelTimeout),n.loadingPanelTimeout=null),n._columnResizing&&(n._columnResizing.destroy(),n._columnResizing=null),n._toolbar&&(n._toolbar.destroy(),n._toolbar=null),n._editing&&(n._editing.destroy(),n._editing=null),n._columnReorder&&(n._columnReorder.destroy(),n._columnReorder=null),n._sortingInProgress=n._loadingVirtualRows=n._scrollLeft=n._scrollTop=n._populateInsertedItem=n._preventClosingEditors=n._editingInProcess=null,n._filter&&(n._filter.destroy(),n._filter=null),n._groupReorder&&(n._groupReorder.destroy(),n._groupReorder=null),n._columnGroupReorder&&(n._columnGroupReorder.destroy(),n._columnGroupReorder=null),n.dataSource.off(o),n.element.off(o).removeClass("sui-grid sui-grid-core").css(te,"").empty()}},_dM:function(){var e=m.createTextNode(x("<div/>").html("&#68;&#101;&#109;&#111;&#32;&#86;&#101;&#114;&#115;&#105;&#111;&#110;").text());x(e).insertAfter(x(this.element))},_resizeHandler:function(){this._adjustWidthsLocked(),this._adjustHeightsLocked()},_hasDetailTemplate:function(){var e=this.options;return e.detailTemplate||e.events&&e.events.detailCreated},_hasVirtualScrolling:function(){var e=this.options;return e.scrolling&&e.scrolling.virtual&&!e.paging&&!this._hasDetailTemplate()},_canExpandCollapse:function(){return!1!==this.options.detailExpandCollapse},_resolveColumns:function(e){var t,i=this;if(i.columns=[],n.array(e))for(t=0;t<e.length;t++)i.columns.push(new Ie(e[t]));else _.error("Invalid columns declaration. The columns have to be array.",i.options.dieOnError);for(i._gridColumns={},t=0;t<i.columns.length;t++)i._gridColumns[i.columns[t].field]={index:t}},_createWrappers:function(){var e,t=this,i=t.element;t._wrapper(),(e=x("<div/>").prependTo(i)).addClass("sui-gridcontent"),(i=x("<div/>").prependTo(i)).addClass("sui-gridheader"),t.options.showHeader||(i.css(D,A),e.addClass("sui-no-header")),t.headerWrapper=i,t.contentWrapper=e},_wrapper:function(){var e=this.options.height,t=this.element;(t=t.is("div")?t:t.wrap("<div/>").parent()).addClass("sui-grid sui-grid-core"),t&&t.css(te,e)},_createGroupPanel:function(){var e,t,i,n=this,r=n.options.grouping,o=!1,l=n.dataSource,a=n.element.find(".sui-group-panel");if(0<a.length&&a.remove(),r.showGroupHeader)if(l.group&&0!==l.group.length){for(e=x('<div class="sui-group-panel"/>'),x(n.element).prepend(e),i=0;i<l.group.length;i++)t=l.group[i],n._createGroupHeaderIndicator(t,e),o=!0;o&&r.allowDragToGroup&&(n._groupReorder&&n._groupReorder.destroy(),n._groupReorder=new We(n),n._columnGroupReorder&&n._columnGroupReorder.destroy(),n._columnGroupReorder=new Pe(n))}else x(n.element).prepend(x('<div class="sui-group-panel sui-group-panel-empty">'+r.message+"</div>"))},_createGroupHeaderIndicator:function(e,t){var i=this,n=i._getColumnByField(e.field),n=n?n.groupTitle:e.field,t=x('<div class="sui-group-panel-indicator" data-field="'+e.field+'"/>').appendTo(t),e=("desc"==e.order?x('<span class="sui-descending">&#9660;</span>'):x('<span class="sui-ascending">&#9650;</span>')).appendTo(t);e.on(H,N(i._sortButtonClickedHandler,i)),x('<span class="sui-group-title">'+n+"</span>").appendTo(t),i.options.grouping.allowDragToGroup&&x('<span class="sui-group-close-button">&#10006;</span>').on(H,N(i._closeButtonClickedHandler,i)).appendTo(t)},_sortButtonClickedHandler:function(e){for(var t=x(e.currentTarget),i=t.parent().attr("data-field"),n=this.dataSource.group,r=0;r<n.length;r++)n[r].field==i&&(t.hasClass("sui-descending")?n[r].order="asc":n[r].order="desc",this.dataSource.read())},_closeButtonClickedHandler:function(e){var t,e=x(e.currentTarget).parent().attr("data-field");this.dataSource.group&&!(t=this.trigger(z,{commandName:ce,cancel:!1,field:e})).cancel&&(this.ungroup(e),this.trigger(ce,t))},_createHeaderTable:function(){var e=this,t=e.headerWrapper,i=e.element;i.is("table")||(i=t.children("table")).length||(i=x("<table/>").appendTo(t)),E&&i.attr("cellspacing",0),i.addClass("sui-table"),e.headerTable=i,e._createTbody(i,!0),e._createThead(i),e._createFakeRow(i,e.columns.length)},_createContentTable:function(){var e=this,t=e.options,i=e.contentWrapper,n=e.element;n.is("table")||(n=i.children("table")).length||(n=x("<table/>").appendTo(i)),E&&n.attr("cellspacing",0),n.addClass("sui-table"),t.rowHover&&n.addClass("sui-hover"),e._hasDetailTemplate()&&(e._canExpandCollapse()&&n.addClass("sui-expandable"),n.on(H+e._eventNS,"> tbody > tr > .sui-expand-cell, > tbody > tr > .sui-collapse-cell",N(e._expandCollapseDetailTemplate,e))),e.contentTable=n,e._createTbody(e.contentTable,!1)},_createTbody:function(e,t){var i=e.find("> tbody");i.length||(i=x("<tbody/>").appendTo(e)),t&&i.addClass("sui-hide"),e.tbody=i},_createThead:function(e){this.options;var t,i,n,r,o,l,a,s=this.columns,d="",c=e.find(">thead");for(c.length||(c=x("<thead/>").insertBefore(e.tbody)),(n=(n=e.find("tr:has(th):first")).length||(n=c.children().first()).length?n:x("<tr/>").appendTo(c)).attr($,V),n.empty(),t=0,i=s.length;t<i;t++)o=(r=s[t]).headerTemplate||r.title||r.field||r,l=!!s[t].sortable,d+="<th "+be(r.headerAttributes)+' data-field="'+s[t].field+'" role="columnheader"'+(l?' tabindex="-1"':"")+">"+o+"</th>";n.html(d),n.addClass("sui-columnheader"),n.find("th").addClass("sui-headercell"),s.length&&this._hasDetailTemplate()&&this._canExpandCollapse()&&(a=x('<th class="sui-indent-cell"/>'),E&&a.html("&nbsp;"),a.prependTo(n)),e.thead=c},_createFakeRow:function(e,t){var i,n,e=e.find(">tbody");if(e.length){for(i=x("<tr/>"),n=0;n<t;n++)x("<td/>").appendTo(i);i.appendTo(e)}},_createColgroup:function(e){var t,i,n,r=this.options,o=this.columns,l=e.find(">colgroup");for((l=l.length?l:x("<colgroup/>").prependTo(e)).html(""),r.columns.length&&this._hasDetailTemplate()&&this._canExpandCollapse()&&x('<col class="sui-indent-col"/>').appendTo(l),t=0,i=o.length;t<i;t++)n=o[t].width,x(n&&0!==parseInt(n,10)?T('<col style="width:{0}"/>',k(n)?n:n+"px"):"<col/>").data(G,o[t].field).appendTo(l)},scrollTop:function(e){var t=this,i=t.options.scrolling,n=t._hasVirtualScrolling(),r=t.contentWrapper;if(i){if(!I(e))return n?t.virtualizedContainer?t.virtualizedContainer.scrollTop():void 0:x(r).scrollTop();n?t.virtualizedContainer&&t.virtualizedContainer.scrollTop(e):x(r).scrollTop(e)}},_scrolling:function(){var e=this,t=e.options,i=x(e.element),n=(g.isRtl(i),e.dataSource),r=e._hasVirtualScrolling(),o=e.headerWrapper,l=e.contentWrapper,a=o.outerHeight(),s=!(r||"auto"!==t.height&&I(t.height)),t=!r&&I(t.maxHeight)?parseInt(t.maxHeight,10):C,d=0,c=0,u=0;if(o.parent().hasClass("sui-gridheader sui-scrolldiv")?a=o.parent().outerHeight():(o.addClass("sui-headercontent").removeClass("sui-gridheader"),o.wrap('<div class="sui-gridheader sui-scrolldiv"/>'),l.addClass("sui-content").removeClass("sui-gridcontent"),l.wrap('<div class="sui-gridcontent sui-scroller"/>'),E&&(e.headerTable.addClass("sui-table-ie7").removeClass("sui-table"),e.contentTable.addClass("sui-table-ie7").removeClass("sui-table")),(e.scrollableWrapper=r?l.parent():l).on("scroll",N(e._onscroll,e))),e.pagerWrapper&&(d=e.pagerWrapper.outerHeight()),e._toolbar){for(var p=i.find(".sui-toolbar"),h=0,f=0;f<p.length;f++)h+=x(p[0]).outerHeight();c+=h+1}var o=i.find(".sui-group-panel");0<o.length&&(u+=o.outerHeight()),o=s?"auto":i.innerHeight()-a-d-c-u,x(l).add(l.parent()).css(te,o),t&&t<i.innerHeight()&&(o=t-a-d-c-u,x(l).add(l.parent()).css(te,o)),r?(e._ensureVirtualizedContainer(),e.virtualizedContainer.options.total=n.total,e.virtualizedContainer.render(),e._fixHeaderPadding(e.virtualizedContainer.wrapper.parent())):(e._fixHeaderPadding(l),s||!Y||E||K||g.hasScrollbarX(l)||l.css(te,o+1))},_fixHeaderPadding:function(e){var t=g.isRtl(this.element),i=this.headerWrapper,e=x(e).get(0);e&&(1<e.scrollHeight-e.clientHeight?(i.parent().css(t?"padding-left":"padding-right",g.scrollbar()-1),i.removeClass("sui-no-y-scroll")):(i.parent().css(t?"padding-left":"padding-right",0),i.addClass("sui-no-y-scroll")))},_ensureVirtualizedContainer:function(){var e,t,i=this;i.virtualizedContainer||(t=(e=i._renderRow(0,i.contentTable.tbody,{})).outerHeight(),e.remove(),i.virtualizedContainer=new _.ui.VirtualizedContainer(i.scrollableWrapper,{itemHeight:t,total:i.dataSource.total,createContainer:function(e){return e.addClass("sui-content").append(i.contentTable).find("tbody").empty()},getItems:N(i._loadVirtualRows,i),skipRender:!0}),i.contentWrapper=i.virtualizedContainer.element.children().eq(0))},_loadVirtualRows:function(e,t,i){var n,r,o,l=this,a=l.dataSource,s=null!=a.skip?a.skip:0,d=null!=a.take?a.take:a.view.length,c=l.virtualizedContainer.container;if(e<t)if(!l._sortingInProgress&&a.remote&&(e<s||s+d<=t))clearTimeout(l._loadWaitTimeout),l._loadWaitTimeout=setTimeout((n=e,r=t,o=i,function(){l._loadWaitTimeout=null,a.skip=n,a.take=r-n,l._loadingVirtualRows=!0,a.one("change.shieldGrid"+l.getInstanceId(),function(){l._loadWaitTimeout||(l._loadingVirtualRows=!1)}),a.read().then(function(){if(!l._loadWaitTimeout){c.empty();for(var e=n;e<r&&e<a.total;e++)l._renderRow(e-n,c,a.view[e-n]);l.loading(!1),o([],!1),l.trigger(ne),l.trigger(F)}})}),100);else{c.empty();for(var u=e;u<t&&u<a.total;u++)l._renderRow(u,c,a.view[u]);i([],!1),l.trigger(ne),l.trigger(F)}else l._renderNoRecords();l._checkIfVerticalScroll(),l._initSelection()},_checkIfVerticalScroll:function(){var e=this,t=e.element.find(".sui-virtualized").get(0),i=e.element.get(0);t.scrollHeight>i.scrollHeight?(e.headerWrapper.parent().css("padding-right","16px"),e.headerWrapper.removeClass("sui-grid-no-gap")):(e.headerWrapper.parent().css("padding-right","0px"),e.headerWrapper.addClass("sui-grid-no-gap"))},_onscroll:function(e){var t=this,i=t.scrollableWrapper,n=i.get(0),r=t.headerWrapper,o=i.scrollLeft(),l=r.scrollLeft();g.isRtl(t.element)&&Q&&n.clientHeight<n.scrollHeight&&(o+=n.offsetWidth-n.clientWidth),o!=l&&(r.scrollLeft(o),t._footer&&0<(n=x(t._footer).find(".sui-footer-content")).length&&n.scrollLeft(o)),t.frozenHeaderWrapper&&(l=i.scrollTop())!=t.frozenContentWrapper.scrollTop()&&t.frozenContentWrapper.scrollTop(l)},_sorting:function(){var e=this,t=e.options.sorting;e.element;t&&e.columns.length&&(e.sorting&&e.sorting.destroy(),e.sorting=new Re(t,e))},_renderData:function(){var i,e,t=this,n=t.dataSource.view,r=t.options;r.scrolling,B(r.altRows)||r.altRows,r.rowTemplate,r.altRowTemplate,t.contentTable;t._loadingVirtualRows||t.trigger(z,{commandName:F,cancel:!1}).cancel||(t._sortingInProgress=!1,t.columns.length||(i=[],n.length&&O(n[0],function(e,t){i.push(e)}),r.columns=i,t._resolveColumns(i)),t._filtering(),t._destroyFrozenContainers(),t._createThead(t.headerTable),t._createColgroup(t.headerTable),t._createColgroup(t.contentTable),t.contentTable.tbody.empty(),t._sorting(),t._renderRows(),t._renderFooter(),e=(r=function(e){return x("<div/>").html(e).text()})("&#83;&#104;&#105;&#101;&#108;&#100;&#85;&#73;"),t._refreshColVisibility(),n&&0<n.length&&t._initFrozenCols(),t._initSelection(),t.loading(!1),n=r("&#104;&#116;&#116;&#112;&#58;&#47;&#47;&#119;&#119;&#119;&#46;&#115;&#104;&#105;&#101;&#108;&#100;&#117;&#105;&#46;&#99;&#111;&#109;"),t.trigger(F),t.dmL||(t.dmL=x('<a href="'+n+'" target="_blank"> by '+e+"</a>"),x(t.dmL).css({color:"grey","text-decoration":"none"}).insertAfter(x(this.element))))},_renderRows:function(){var e,t=this,i=t.dataSource,n=i.view;if(t._markedCells){for(e in t._markedCells)t._markedCells.hasOwnProperty(e)&&(t._markedCells[e].length=0);t._markedCells=null}if(!n||!n.length)return t._renderNoRecords(),t._createGroupPanel(),t._addGroupIndentCells(),void t._initScrolling();t._hasVirtualScrolling()&&!t._sortingInProgress||((i=i.group)&&0<i.length?(t._renderGroupedData(n,0,0),t._addGroupIndentCells(),t._addGroupDataIndentCells(),t.contentTable.addClass("sui-grouped-table")):t._renderRowsAndDetails(n)),t._createGroupPanel(),t._initScrolling()},_addGroupIndentCells:function(){var e,t,i,n,r,o=this,l=o.dataSource.group,a=o.options,a=a.filtering&&a.filtering.enabled;if(l&&0<l.length)for(e=o.headerTable.find(">colgroup").first(),t=o.contentTable.find(">colgroup").first(),i=o.headerTable.thead.find(".sui-columnheader").first(),a&&(n=o.headerTable.find(".sui-filter-row").first()),e.find(".sui-indent-col").remove(),i.find(".sui-columnheader > .sui-indent-cell").remove(),n&&0<n.length&&n.find(".sui-indent-cell").remove(),r=0;r<l.length;r++)x('<col class="sui-indent-col"/>').prependTo(e),x('<th class="sui-indent-cell"/>').prependTo(i),n&&0<n.length&&x('<th class="sui-indent-cell"/>').prependTo(n),x('<col class="sui-indent-col"/>').prependTo(t)},_getVisibleColumnCount:function(){for(var e=this.columns||[],t=e.length,i=0,n=0;n<t;n++)e[n].visible&&i++;return i},_renderNoRecords:function(){var e=this.options,t=this.contentTable;(B(e.noRecordsTemplate)?x('<tr><td class="sui-grid-norecords-cell" colspan="'+this._getVisibleColumnCount()+'" role="gridcell">'+(e.noRecordsText||"No records to display")+"</td></tr>"):x('<td class="sui-grid-norecords-cell" colspan="'+this._getVisibleColumnCount()+'" role="gridcell"/>').append(e.noRecordsTemplate).wrap("<tr/>").parent()).appendTo(t.tbody)},_initScrolling:function(){this.options.scrolling&&!this._sortingInProgress&&this._scrolling()},_initSelection:function(){this._selection()},_addGroupDataIndentCells:function(){for(var e,t,i,n=this.contentTable.get(0).rows,r=0;r<n.length;r++)if(t=x(n[r]),i=parseInt(t.attr("data-group-level"),10),t.hasClass("sui-group-header")){if(1<i)for(e=0;e<i-1;e++)x('<td class="sui-indent-cell"/>').prependTo(t)}else for(e=0;e<i;e++)x('<td class="sui-indent-cell sui-group-intend-cell"/>').prependTo(t)},_renderGroupedData:function(e,t,i){var n,r,o=this;for(o.options.detailExpandCollapse=!1,n=0;n<e.length;n++)(r=e[n]).hasOwnProperty("field")&&r.hasOwnProperty("items")&&r.hasOwnProperty("value")?(o._renderGroupHeader(r,++i),o._renderGroupedData(r.items,t,i),o._renderGroupAggregates(r),i--):(o._renderDataItem(r,t,i),t++)},_renderGroupAggregates:function(e){if(e.aggregate){var t,i,n,r=this,o=r.columns,l={},a=e.aggregate;for(p=0;p<o.length;p++)if(i=o[p].groupFooterTemplate){t=x("<tr class='sui-group-footer' />").appendTo(r.contentTable.tbody);break}if(t){for(p=0;p<o.length;p++)if(n=x("<td class='sui-group-footer-cell' />").appendTo(t),i=o[p].groupFooterTemplate){for(var s,d=o[p].field,c=0;c<a.length;c++)a[c].field==d&&(S(a[c].aggregate)?l.custom=a[c].value:l[a[c].aggregate]=a[c].value);S(i)?(s=i.call(r,n,l),I(s)&&!q(s)&&""!==s&&n.html(s)):n.html(T.call(r,i,l))}for(var u=r.dataSource.group.length,p=0;p<u;p++)t.prepend(x("<td class='sui-indent-cell' />"))}}},_renderGroupHeader:function(e,t){var i=this,n=i.contentTable,r=i._getVisibleColumnCount()+i.dataSource.group.length-t+1,t=x('<tr class="sui-group-header" data-group-level="'+t+'"/>').appendTo(n),n=x('<td class="sui-group-header-cell" colspan="'+r+'"/>').appendTo(t),r=x('<span class="sui-collapse">&#9662;</span>').appendTo(n),t=i._getColumnByField(e.field),t=t?t.groupHeaderTitle:e.field;x('<span class="sui-group-header-text">'+t+": "+e.value+"</span>").appendTo(n),r.on(H,N(i._expandCollapseHandler,i))},_expandCollapseHandler:function(e){var t=this,e=x(e.currentTarget),i=e.parent().parent();e.hasClass("sui-collapse")?t.trigger(z,{commandName:me,cancel:!1,row:i}).cancel||(t.collapseGroup(i),e.html("&#9656;"),e.removeClass("sui-collapse").addClass("sui-expand"),t.trigger(me,{row:i})):t.trigger(z,{commandName:"expand",cancel:!1,row:i}).cancel||(t.expandGroup(i),e.html("&#9662;"),e.removeClass("sui-expand").addClass("sui-collapse"),t.trigger("expand",{row:i}))},_renderDataItem:function(e,t,i){var n=this.contentTable;this._renderRow(t,n,e).attr("data-group-level",i)},_renderRowsAndDetails:function(e){for(var t=this,i=t.contentTable,n=0,r=e.length;n<r;n++)t._renderRow(n,i.tbody,t.dataSource.view[n]),t._hasDetailTemplate()&&!t._canExpandCollapse()&&t._addDetailTemplate(e[n])},_renderRow:function(e,t,i){var n,r,o=this,l=I(t),a=o.options,s=!!B(a.altRows)||a.altRows,d=s&&e%2&&a.altRowTemplate?a.altRowTemplate:a.rowTemplate,c=o.columns;if(d)k(d)&&(d=d.replace(/^\s+/,"").replace(/\s+$/,"")),p=x(T(d,i)),l&&t.append(p);else{var u,p=x('<tr class="'+(s&&e%2?"sui-alt-row":"sui-row")+'"/>').data(ve,e);for(3<arguments.length?(d=arguments[3],u=(s=t.find("tr")).eq(d),s.length==d?t.append(p):p.insertBefore(u)):l&&t.append(p),r=0;r<c.length;r++){var h,f,g=c[r],_=g.columnTemplate,m=g.format,v=g.field,b=g.buttons,C=x("<td "+be(g.attributes)+' role="gridcell" tabindex="-1"/>').addClass("sui-cell").appendTo(p);if(C.attr($,"gridcell").attr(W,"-1"),g.editable||C.attr(Z,ee),b)for(f=0;f<b.length;f++)o._buildButton(b[f],C,e);else _?S(_)?(h=_.call(o,C,i,e),I(h)&&!q(h)&&""!==h&&C.html(h)):C.html(T.call(o,_,i)):m?C.html(T.call(o,m,v?y(i,v):i)):C.html(""+y(i,v));g.visible||C.css(D,A)}}return o._hasDetailTemplate()&&o._canExpandCollapse()&&(o.trigger(z,{commandName:"expandButtonCreate",cancel:!1,item:i}).cancel?n=x('<td class="sui-cell sui-expand-cell-disabled"/>'):(n=x('<td class="sui-cell sui-expand-cell"/>'),o._setExpandCollapseCellText(n,a.detailExpandText,a.detailCollapseText)),n.prependTo(p)),p.attr($,V),p},_renderFooter:function(){var e,t,i,n,r,o,l=this,a=l.options,s=l.columns,d={},c=l.dataSource.aggregates;for(l._footer&&(x(l._footer).remove(),l._footer=null),n=0;n<s.length;n++)if(t=s[n].footerTemplate){if(a.scrolling&&a.scrolling.virtual){for(var u=x('<div class="sui-footer" style="padding-right:16px;"/>').appendTo(l.element),p=x('<div class="sui-footer-content"/>').appendTo(u),p=x('<table class="sui-table"/>').appendTo(p),h=l.element.find(".sui-headercontent > table > colgroup > col"),f=x("<colgroup/>").appendTo(p),g=0;g<h.length;g++)x(h[g].outerHTML).appendTo(f);p=x("<tbody/>").appendTo(p),l._footer=u}else p=x("<tfoot/>").appendTo(l.contentTable),l._footer=p;e=x('<tr class="sui-grid-footer"/>').appendTo(p);break}if(e){for(n=0;n<s.length;n++)if(r=x('<td class="sui-footer-cell" role="gridcell" tabindex="-1"/>').appendTo(e),t=s[n].footerTemplate){for(i=s[n].field,g=0;g<c.length;g++)c[g].field==i&&(S(c[g].aggregate)?d.custom=c[g].value:d[c[g].aggregate]=c[g].value);S(t)?(o=t.call(l,r,d),I(o)&&!q(o)&&""!==o&&r.html(o)):r.html(T.call(l,t,d))}var _=e.prev();(0<(_=_.length<=0?l.contentTable.find(">tbody > tr").first():_).find(".sui-expand-cell").length||0<_.find(".sui-expand-cell-disabled").length||0<_.find(".sui-indent-cell").length||0<_.find(".sui-collapse-cell").length)&&e.prepend(x("<td/>"))}},_buildButton:function(e,t,i){var n,r=this,o=e.commandName,l=e.click;_.ui.Button&&(n=x('<button type="button">'+e.caption+"</button>").appendTo(t),t.addClass("sui-button-cell"),"delete"===o?(l=r._deleteButtonClicked,B(e.cls)?e.cls="sui-delete":e.cls+=" sui-delete"):"edit"===o&&(r._editing&&(r._editing.type=V),r._preventClosingEditors=!0,l=r._editButtonClicked,B(e.cls)?e.cls="sui-edit":e.cls+=" sui-edit"),n=new _.ui.Button(n,{cls:e.cls,events:{click:N(l,r,i,t)}}),"delete"!=o&&"edit"!=o||(r._buttons||(r._buttons=[]),r._buttons.push({index:i,button:n})))},_deleteButtonClicked:function(e,t){var i=this.dataSource,n=this.options.editing,r=n?n.confirmation:null;this.trigger(z,{commandName:"delete",cancel:!1,rowIndex:e}).cancel||r&&r.delete&&r.delete.enabled&&!s.confirm(T(r.delete.template,i.view[e]))||(i.removeAtView(e),n&&!n.batch&&i.save(!1),this.trigger("delete",{rowIndex:e}))},_editButtonClicked:function(e,t){var i=this,n=i._editing,r=i.dataSource,o=x(t).parent();i.trigger(z,{commandName:fe,cancel:!1,row:o,cell:t,index:i._getRowIndex(o)}).cancel||(i._editingInProcess=!0,r.tracker&&r.tracker.changes&&r.tracker.changes.added&&0<r.tracker.changes.added.length?r.cancel():"popup"!=i.options.editing.mode?(i._closeAllEditedRows(),n&&n.options.enabled&&n._putRowInEditMode(o,0),i._changeEditColumnButtons(e,t)):_.ui.Window&&i._initializePopupForm(e),i.trigger(fe,{row:x(t).parent(),cell:t,index:i._getRowIndex(x(t).parent())}))},_initializePopupForm:function(e,t){for(var i,n=this,r=n._editing,o=n.dataSource,l=x('<div class="sui-modal-popup-edit-window"/>').appendTo(m.body),a=x('<div class="sui-edit-form-container"/>'),s=n.options.columns,d=0;d<s.length;d++)if(!1!==(i=s[d]).editable&&i.field){var c=I(o.schema.options.fields)?o.schema.options.fields[i.field].type:String,u=o.editView(e).data,p=y(u,i.field),h=(n._windowEditingIndex=e,x('<div class="sui-edit-form-label"><label for="'+i.field+'">'+(i.caption||i.field)+"</label></div>").appendTo(a),x('<div class="sui-edit-field"></div>').appendTo(a));if(i.editor)r._instantiateCustomEditor(i,h,u,0,!1,i.field);else switch(c){case Number:r._instantiateNumeric(h,p,!1,i.field);break;case Date:r._instantiateDatePicker(h,p,!1,i.field);break;case String:r._instantiateTextBox(h,p,!1,i.field);break;case Boolean:r._instantiateCheckBox(h,p,!1,i.field)}}var f=x('<div class="sui-update-buttons sui-popup-buttons"></div>').appendTo(a),g=x("<button type='button'>Save</button>").appendTo(f),f=x("<button type='button'>Cancel</button>").appendTo(f);_.ui.Button&&(g=new _.ui.Button(g,{events:{click:N(n._updateButtonClicked,n)}}),f=new _.ui.Button(f,{events:{click:N(n._cancelButtonClicked,n)}}),n._buttons=[],n._buttons.push({index:1e4,button:g}),n._buttons.push({index:1e4,button:f})),a.appendTo(m.body),n.popupWindow=new _.ui.Window(l,{title:t?"Insert":"Edit",draggable:{enabled:!1},events:{close:N(n._cancelButtonClicked,n)},height:x(".sui-edit-form-container").height()+57,modal:!0}),n.popupWindow.content(a),n.popupWindow.resize({width:x(".sui-modal-popup-edit-window").width(),height:x(".sui-edit-form-container").height()+66}),n.trigger(t?"insertWindowOpen":"editWindowOpen")},_changeEditColumnButtons:function(e,t){var i=this;i._removeButtons(t,e),i._buildButton({caption:"Update",click:i._updateButtonClicked,cls:"sui-update"},t,e),i._buildButton({caption:"Cancel",click:i._cancelButtonClicked,cls:"sui-cancel"},t,e),t.addClass("sui-update-buttons")},_removeButtons:function(e,t){for(var i=this._buttons.length;i--;)this._buttons[i].index==t&&(this._buttons[i].button.destroy(),this._buttons.splice(i,1));e.removeClass("sui-update-buttons").empty()},_updateButtonClicked:function(e,t){var i=this;B(i._windowEditingIndex)||(e=i._windowEditingIndex),i._updateItem(e,t),i._editing._errorDuringEdit?i._editing._errorDuringEdit=!1:(i._putRowInViewMode(e,t),"popup"===i.options.editing.mode&&i._removePopupWindow())},_updateItem:function(e,t){var i,n,r,o,l,a,s=this,d=s.dataSource,c=(s.pager,[]),u=!0;if(d.group&&0<d.group.length&&"popup"!=s.options.editing.mode)for(o=s.contentTable.find(".sui-row, .sui-alt-row"),l=s.contentTable.find("tr").get(e),a=0;a<o.length;a++)if(o[a]==l){e=a;break}for(r in(i=d.editView(e)).data)i.data.hasOwnProperty(r)&&(null!=i.data[r]&&(u=!1),s._editing._editors[r]&&("custom"==s._editing._editors[r]?(n=s.trigger("getCustomEditorValue",{field:r,value:null}).value,s._editing._editors[r]=null):n=s._editing._editors[r].value?s._editing._editors[r].value():s._editing._editors[r].checked?s._editing._editors[r].checked():C,i.data[r]!=n&&c.push(r),!B(n)&&null!=n||(n=s._getDefaultValue(r)),i.set(r,n)));if(!s._editing._errorDuringEdit)return s._editing.options.batch||s.trigger(z,{commandName:ge,cancel:!1}).cancel||(d.save(!1),s.trigger(ge)),s._populateInsertedItem=u,c;c.length=0},_getDefaultValue:function(e){var t=this.dataSource.schema;return t&&t.options.fields?(t=t.options.fields,_.Model.def(y(t,e+".type"),y(t,e+".def"),y(t,e+".nullable"))):""},_closeAllEditedRows:function(){var e,t=this.contentTable.find(".sui-editable-cell");0<t.length&&(t=t.get(0).parentNode.rowIndex,e=this.contentTable.find(".sui-update-buttons").get(0),this._cancelButtonClicked(t,x(e)))},_cancelButtonClicked:function(e,t){var i,n,r,o=this,l=o.dataSource;if(!o.trigger(z,{commandName:he,cancel:!1,rowIndex:e,cell:t}).cancel){if(l.tracker&&l.tracker.changes&&l.tracker.changes.added&&0<l.tracker.changes.added.length)l.cancel(),"popup"===o.options.editing.mode&&o._removePopupWindow();else if("popup"!=o.options.editing.mode)o._putRowInViewMode(e,t);else{for(i=o.options.columns,n=0;n<i.length;n++)(r=o._editing._editors[i[n].field])&&(S(r.destroy)&&o._editing._editors[i[n].field].destroy(),delete o._editing._editors[i[n].field]);o._removePopupWindow()}o.trigger(he)}},_removePopupWindow:function(){this._removeButtons(x(".sui-window .sui-update-buttons"),1e4),this.popupWindow.destroy(),x(".sui-modal-popup-edit-window").remove()},_getRowIndex:function(e){e=x(e).data(ve);return I(e)?e:-1},_putRowInViewMode:function(e,t){var i,n=this,r=n.options,o=r.navigation,l=n.dataSource,a=n.contentTable,s=e,d=-1;if(l.group&&0<l.group.length&&"popup"!=r.editing.mode)for(i=a.find(">tbody > tr.sui-row, >tbody > tr.sui-alt-row"),c=a.find(">tbody > tr").get(e),_=0;_<i.length;_++)if(i[_]==c){s=_;break}l=l.view[s],t&&"popup"!=r.editing.mode&&n._removeButtons(t,e);var c=a.find(">tbody > tr").get(e),u=parseInt(x(c).attr("data-group-level"),10);for(o&&(d=x(c).children("td").index(n._activeCell)),n._editing._destroyRow(e),c=n._renderRow(s,n.contentTable.tbody,l,e),o&&-1<d&&(n._activeCell=x(c).children("td").eq(d),x(n._activeCell).focus()),_=0;_<u;_++)x('<td class="sui-indent-cell sui-group-intend-cell"/>').prependTo(c);if(u&&c.attr("data-group-level",u),n._editing.options.batch){var p=c.children(".sui-cell");if(n._markedCells&&n._markedCells[e])for(var h,f,g=n._markedCells[e],_=0;_<g.length;_++)h=g[_],f=x(p[h]).html(),x(p[h]).html('<span class="sui-updated-marker"/>'+f)}},_renderUpdateMarkers:function(e,t){for(var i,n,r=this,o=r.columns,l=r.contentTable.find(">tbody > tr").eq(t).children(".sui-cell"),a=0;a<e.length;a++)for(i=0;i<o.length;i++)o[i].field===e[a]&&(n=x(l[i]).html(),x(l[i]).html('<span class="sui-updated-marker"/>'+n),r._markedCells?r._markedCells[t]||(r._markedCells[t]=[]):(r._markedCells={},r._markedCells[t]=[]),r._markedCells[t].push(i))},_selection:function(){var e=this,t=e.options;t.selection&&(e._selectable&&e._selectable.destroy(),e._selectable=new Ee(t.selection,e))},_filtering:function(){var e=this,t=e.options;t.filtering&&t.filtering.enabled&&(e._filter&&e._filter.destroy(),e._filter=new Ne(e))},_paging:function(e){var t=this,i=t.element;_.ui.Pager&&e&&(o(e)&&e instanceof _.ui.Pager?(t.pager=e,t.pager.dataSource=t.dataSource,t.pager.element.appendTo(i)):((i=x("<div/>").appendTo(i)).addClass("sui-pager"),t.pagerWrapper=i,t.pager=new _.ui.Pager(i.get(0),R({},e,{dataSource:t.dataSource}))))},_reorder:function(){this.options.columnReorder&&(this._columnReorder=new ze(this))},_expandCollapseDetailTemplate:function(e){var t=x(e.target).closest(".sui-row",this.contentTable);t.length||(t=x(e.target).closest(".sui-alt-row",this.contentTable)),this._toggleDetailTemplate(t)},_toggleDetailTemplate:function(e){var t=this,i=t.contentTable.find("tr:first").parent().children().not(".sui-detail-row"),i=X(e[0],i),n=t.dataSource.view,r=e.next(),o=t.options;r&&r.hasClass("sui-detail-row")?(r.toggle(),r=x(e.get(0).cells[0]),t._toggleClasses(r,"sui-expand-cell","sui-collapse-cell"),t._setExpandCollapseCellText(r,o.detailExpandText,o.detailCollapseText)):t._addDetailTemplate(n[i],e)},_setExpandCollapseCellText:function(e,t,i){B(i)&&(i="-"),B(t)&&(t="+");var n=this.options.detailCollapseCssClass,r=this.options.detailExpandCssClass,n=B(n)?"":" class = '"+n+"'",r=B(r)?"":" class = '"+r+"'";e.hasClass("sui-collapse-cell")?e.html("<span"+n+">"+i+"</span>"):e.hasClass("sui-expand-cell")&&e.html("<span"+r+">"+t+"</span>")},_addDetailTemplate:function(e,t){var i=this,n=i.options,r=x("<tr class='sui-detail-row'/>"),o=(i._canExpandCollapse()&&(o=x("<td class='sui-cell sui-indent-cell'/>"),E&&o.html("&nbsp;"),o.appendTo(r)),x('<td class="sui-detail-cell" colspan="'+i._getVisibleColumnCount()+'"></td>'));i.trigger(z,{commandName:le,cancel:!1,detailCell:o,item:e}).cancel||(o.appendTo(r),n.detailTemplate&&o.html(T(n.detailTemplate,e)),t?r.insertAfter(t):r.appendTo(i.contentTable.tbody),i.trigger(le,{detailCell:o,item:e}),t&&(r=x(t.get(0).cells[0]),i._toggleClasses(r,"sui-expand-cell","sui-collapse-cell"),i._setExpandCollapseCellText(r,n.detailExpandText,n.detailCollapseText)))},_toggleClasses:function(e,t,i){e.hasClass(t)?(e.removeClass(t),e.addClass(i)):(e.removeClass(i),e.addClass(t))},_resizing:function(){this.options.resizing&&this.options.scrolling&&(this._columnResizing=new Be(this))},_initToolbar:function(){var e=this.options;e.toolbar&&(this._toolbar=new Se(e.toolbar,this))},_initEditing:function(){var e=this.options;e.editing&&(this._buttons=[],this._editing=new ke(e.editing,this))},_refreshOnSort:function(){this._sortingInProgress=!0,this.dataSource.read()},_dsStartHandler:function(){this.loading(!0)},_initNavigation:function(){var t=this,e=t.element,i=t._eventNS+"nav";t.options.navigation&&(e.addClass("sui-grid-nav").off(i).on("focus"+i,".sui-headercell[tabindex], .sui-filter-cell[tabindex], .sui-cell[tabindex], .sui-footer-cell[tabindex]",function(e){x(t._activeCell).attr(W,"-1"),t._activeCell=x(this),x(t._activeCell).attr(W,"0")}),t._initActiveCell(),x(t._activeCell).attr(W,"0"))},_initActiveCell:function(){var e=this;(x(e._activeCell).length<=0||!x(e._activeCell).is(":visible"))&&(e._activeCell=x(e.element).find(".sui-cell[tabindex]").first(),x(e._activeCell).length<=0&&(e._activeCell=x(e.element).find(".sui-headercell[tabindex]").first()))},_cellEditable:function(e){return x(e).attr(Z)!=ee&&!!x(e).hasClass("sui-editable-cell")},_keydown:function(e){var t,i=this,n=i.element,r=e.keyCode,o=i.options,l=o.navigation,a=o.editing,s=o.selection,d=e.ctrlKey,c=(e.shiftKey,i.pager),u=!1,p=i._cellEditable(i._activeCell);if("button"!==x(e.target).prop("tagName").toLowerCase()||r!=h.ENTER&&r!=h.SPACE){switch(r){case h.UP:!l||p||(t=i._getNextNavCell("up"))&&(x(t).focus(),u=!0);break;case h.DOWN:!l||p||(t=i._getNextNavCell("down"))&&(x(t).focus(),u=!0);break;case h.LEFT:!l||p||(t=i._getNextNavCell("left"))&&(x(t).focus(),u=!0);break;case h.RIGHT:!l||p||(t=i._getNextNavCell("right"))&&(x(t).focus(),u=!0);break;case h.HOME:!l||p||(t=d?x(n).find(".sui-cell[tabindex], .sui-headercell[tabindex], .sui-footer-cell[tabindex]").first():i._getNextNavCell("first"))&&(x(t).focus(),u=!0);break;case h.END:!l||p||(t=d?x(n).find(".sui-cell[tabindex], .sui-headercell[tabindex], .sui-footer-cell[tabindex]").last():i._getNextNavCell("last"))&&(x(t).focus(),u=!0);break;case h.ENTER:l&&(x(i._activeCell).hasClass("sui-cell")?a&&(p?i._updateButtonClicked(x(i._activeCell).parent().get(0).rowIndex,x(i._activeCell)):i._editing._editingTriggered(e),u=!0):x(i._activeCell).hasClass("sui-headercell")&&(0<x(i._activeCell).children(".sui-link").length&&(i.one(F,N(i.focus,i)),x(i._activeCell).children(".sui-link").first().click()),u=!0));break;case h.PAGEUP:l&&(c&&c.hasPrev()&&(i.one(F,N(i.focus,i)),i.pager.prev()),u=!0);break;case h.PAGEDOWN:l&&(c&&c.hasNext()&&(i.one(F,N(i.focus,i)),i.pager.next()),u=!0);break;case h.ESC:p&&(i.cancelEditing(),l&&x(i._activeCell).focus(),u=!0);break;case h.SPACE:l&&s&&i._selectable&&!p&&(i._selectable.elements=xe(e,i.contentTable,i.frozenContentTable),i._selectable.elements&&i._selectable._performAndProcessSelection(e),u=!0)}u&&e.preventDefault()}},_getNextNavCell:function(e){var t,i=this,n=(i.element,i._activeCell);return(!n||x(n).length<=0)&&(n=x(i.element).find('.sui-cell[tabindex="0"], .sui-headercell[tabindex="0"]').first()),"left"==e?t=i.__findPrevFocusCell(n):"right"==e?t=i.__findNextFocusCell(n):"up"==e?t=i.__findAboveFocusCell(n):"down"==e?t=i.__findBelowFocusCell(n):"first"==e?t=i.__findFirstFocusCell(n):"last"==e&&(t=i.__findLastFocusCell(n)),t&&0<x(t).length?x(t).get(0):null},__findFirstFocusCell:function(e){for(var t,i=this.__findPrevFocusCell(e);i&&0<i.length;)t=i,i=this.__findPrevFocusCell(i);return t},__findLastFocusCell:function(e){for(var t,i=this.__findNextFocusCell(e);i&&0<i.length;)t=i,i=this.__findNextFocusCell(i);return t},__findPrevFocusCell:function(e){for(var t=x(e).prev();t&&0<t.length;){if(Ce(t,W))return t;t=x(e).prev()}return C},__findNextFocusCell:function(e){for(var t=x(e).next();t&&0<t.length;){if(Ce(t,W))return t;t=x(e).next()}return C},__findAboveFocusCell:function(e){for(var t,i=x(e).closest("tr"),n=x(e).index(),r=this.headerTable.find(">thead > tr").add(this.contentTable.find(">tbody > tr")).add(this.contentTable.find(">tfoot > tr")),o=x(r).index(i);0<o;){if(Ce(t=x(x(r)[o-1]).children().eq(n),W))return t;o--}return C},__findBelowFocusCell:function(e){for(var t,i=x(e).closest("tr"),n=x(e).index(),r=this.headerTable.find(">thead > tr").add(this.contentTable.find(">tbody > tr")).add(this.contentTable.find(">tfoot > tr")),o=x(r).index(i);o<r.length-1;){if(Ce(t=x(x(r)[o+1]).children().eq(n),W))return t;o++}return C},focus:function(){var e=this;e.options.navigation?(e._initActiveCell(),0<x(e._activeCell).length?x(e._activeCell).focus():ye(e.element)):ye(e.element)},refresh:function(e){var t=this,i=e?e.dataSource:null,n=t._eventNS;e=_.extend([a],t.options,e),i&&(e.dataSource=i);var i=t.element,r=e.scrolling,o=t.pager?t.pager.options:e.paging,l=0;r&&t.contentWrapper&&(l=t.contentWrapper.get(0).scrollLeft),t._destroyInternal(),r=t.dataSource=M.create(e.dataSource),i.attr($,"grid").on(re+n,N(t._keydown,t)),e.editing||i.attr(Z,ee),r.on("change"+n,N(t._renderData,t)).on("start"+n,N(t._dsStartHandler,t)),x(s).on("resize"+n,N(t._resizeHandler,t)),t._resolveColumns(e.columns),t._createWrappers(),t._createHeaderTable(),t._createContentTable(),t._initToolbar(),t._initEditing(),t._filtering(),t._paging(o),t._resizing(),t._reorder(),t._initNavigation(),t.pager||t.dataSource.read(),t._sorting(),l&&(t.contentWrapper.get(0).scrollLeft=l)},loading:function(e,t){function i(){n.loadingPanel&&n.loadingPanel.show()}var n=this;_.ui.LoadingPanel&&(e?(n.loadingPanel||(n.loadingPanel=new _.ui.LoadingPanel(n.element.get(0))),t?i():n.loadingPanelTimeout=setTimeout(i,50)):n.loadingPanel&&(clearTimeout(n.loadingPanelTimeout),n.loadingPanelTimeout=null,n.loadingPanel.hide()))},select:function(e){var t=this._selectable;return(e=k(e)?this.contentTable.find(e):x(e)).length?(t.multiple||(t.clear(),e=e.first()),void t.select(e)):t.select()},selectedRowIndices:function(){var t=this,i=[],n=[];return t.contentTable.children("tbody").children(".sui-row, .sui-alt-row").each(function(){var e;x(this).hasClass(P)&&(e=t._getRowIndex(x(this)),i.push(e),n.push(0<=e?t.dataSource.getDataIndex(e):e))}),{view:i,data:n}},clearSelection:function(){this._selectable.clear()},sort:function(e,t,i){this.sorting&&this.sorting._sort(e,t,i)},_getItemRow:function(e){return t(e)?x(this.contentTable.children("tbody").children(".sui-row, .sui-alt-row").get(e)):x(e)},expandRow:function(e){var e=this._getItemRow(e),t=e.next();t.hasClass("sui-detail-row")&&t.css(D)!=A||this._toggleDetailTemplate(e)},collapseRow:function(e){var e=this._getItemRow(e),t=e.next();t.hasClass("sui-detail-row")?t.css(D)!=A&&this._toggleDetailTemplate(e):(this._toggleDetailTemplate(e),e.next().toggle())},reorderColumn:function(e,t,i){var n,r=this.element,o=this.columns,l=this.options.columns||[],a=this.headerWrapper,s="before",a=a.find(".sui-columnheader").first().find(".sui-indent-cell").length;if(e=+e,t=+t,isNaN(e)||isNaN(t)||e<0||t<0||e>o.length-1||t>o.length-1)throw new Error("Invalid index in column reorder.");e!==t&&(e<t&&(s="after"),!(n=o[e]).visible||!i&&n.locked||(n=o.splice(e,1)[0],o.splice(t,0,n),n=l.splice(e,1)[0],l.splice(t,0,n),t+=a,r.find(".sui-gridheader col:nth-child("+((e+=a)+1)+")").add(r.find(".sui-gridheader .sui-columnheader th:nth-child("+(e+1)+")")).add(r.find(".sui-gridheader .sui-filter-row th:nth-child("+(e+1)+")")).add(r.find(".sui-gridcontent col:nth-child("+(e+1)+")")).add(r.find(".sui-gridcontent tr:not(.sui-detail-row) td:nth-child("+(e+1)+")")).each(function(){x(this).parent().children().eq(t)[s](this)})))},addRow:function(e){return this.dataSource.add(I(e)?e:{})},insertRow:function(e,t){return this.dataSource.insertView(e,I(t)?t:{})},saveChanges:function(){this.dataSource.save()},revertChanges:function(){this.dataSource.cancel()},dataItem:function(e){return this.dataSource.view[e]},editCell:function(e,t){e=this.contentTable.find(">tbody > tr").eq(e).children("td").eq(t).get(0);this._editingInProcess=!0,this._editing._putCellInEditMode(e)},editRow:function(e){e=this.contentTable.find(">tbody > tr").eq(e).get(0);this._editingInProcess=!0,this._editing._putRowInEditMode(x(e),0)},editRowPopup:function(e){this._editingInProcess=!0,_.ui.Window&&this._initializePopupForm(e)},cancelEditing:function(){var e,t=this.contentTable.find(".sui-editable-cell");0<t.length&&(t=t.get(0).parentNode.rowIndex,e=this.contentTable.find(".sui-update-buttons").get(0),this._putRowInViewMode(t,x(e))),this._editingInProcess=!1},deleteRow:function(e){this.dataSource.removeAtView(e)},filter:function(){var e=this.dataSource,t=[].slice.call(arguments);if(!(0<t.length))return e.filter;e.filter=t[0],e.read()},group:function(e,t,i,n){var r=this.dataSource.group;r?r.splice(t,0,{field:e,order:i,aggregates:n}):(this.dataSource.group=[],this.dataSource.group.push({field:e,order:i,aggregates:n}))},ungroup:function(e){var t,i=this.dataSource.group,n=!1;for(this.headerTable.thead.find(".sui-columnheader > .sui-indent-cell").remove(),t=0;t<i.length;t++)if(i[t].field==e){i.splice(t,1),0===i.length&&(this.dataSource.group=null),n=!0;break}n&&this.dataSource.read()},collapseGroup:function(e){for(var t=!0,i=parseInt(e.attr("data-group-level"),10);t;)0<(e=e.next().css(D,A)).next().length&&!(parseInt(e.next().attr("data-group-level"),10)<=i&&e.next().hasClass("sui-group-header"))||(t=!1)},expandGroup:function(e){for(var t=!0,i=parseInt(e.attr("data-group-level"),10);t;){if((e=e.next().css(D,"")).hasClass("sui-group-header")&&0<e.find(".sui-expand").length)return;0<e.next().length&&!(parseInt(e.next().attr("data-group-level"),10)<=i&&e.next().hasClass("sui-group-header"))||(t=!1)}},_getColumnByField:function(e){for(var t=this.columns||[],i=0;i<t.length;i++)if(t[i].field===e)return t[i];return C},_refreshColVisibility:function(){for(var e=this.columns,t=e.length,i=!1,n=0;n<t;n++)if(!e[n].visible){i=!0;break}if(i)for(n=0;n<t;n++)e[n].visible?this.showColumn(e[n].field):this.hideColumn(e[n].field)},_getNextVisibleColumnRealIndex:function(e){for(var t=this.columns,i=e.index+1;i<t.length;i++)if(t[i].visible)return i;return-1},isHidden:function(e){e=this._getColumnByField(e);return e?!e.visible:C},hideColumn:function(e){var t=this,i=(x(t.element),t._getColumnByField(e));i&&!i.locked&&(x(t.headerTable).find("colgroup").first().find("col").each(function(){if(x(this).data(G)==e)return t._gridColumns[e].headerCol=x(this),x(this).detach(),!1}),x(t.contentTable).find("colgroup").first().find("col").each(function(){if(x(this).data(G)==e)return t._gridColumns[e].contentCol=x(this),x(this).detach(),!1}),t._changeColumnVisibility(e,"hide"),i.visible=!1,t._afterColumnVisibilityChange())},showColumn:function(e){var t,i,n,r,o,l=this,a=(x(l.element),l._getColumnByField(e)),s=x(l.headerTable).find("colgroup"),d=x(l.contentTable).find("colgroup");a&&!a.locked&&(t=l._gridColumns[e],i=t.headerCol,n=t.contentCol,-1===(r=l._getNextVisibleColumnRealIndex(t))?(s.append(i),d.append(n)):(o=l.columns[r].field,s.find("col").each(function(){if(x(this).data(G)==o)return x(i).insertBefore(x(this)),!1}),d.find("col").each(function(){if(x(this).data(G)==o)return x(n).insertBefore(x(this)),!1})),l._changeColumnVisibility(e,"show"),t.headerCol=t.contentCol=C,a.visible=!0,l._afterColumnVisibilityChange())},_changeColumnVisibility:function(t,e){var i,n,r=x(this.element),o=x(this.headerTable).find(".sui-columnheader").first(),l=x(this.headerTable).find(".sui-filter-row").first(),a=this._footer,s=-1;if(o.length&&x(o).children().each(function(e){if(x(this).attr("data-field")==t)return s=e,!1}),!(s<0))for(x(o.find("th")[s])[e](),x(l.find("th")[s])[e](),a&&x(a.find("td")[s])[e](),0===(i=0===(i=r.find("> .sui-gridcontent > table > tbody > tr")).length?r.find("> .sui-gridcontent > .sui-virtualized > table > tbody > tr"):i).length&&(i=r.find("> .sui-gridcontent > .sui-content > table > tbody > tr")),n=0;n<i.length;n++)x(i[n].cells[s])[e]()},_afterColumnVisibilityChange:function(){var e=this._getVisibleColumnCount(),t=this.dataSource,i=t.group?t.group.length:0;x(this.contentTable).find(".sui-grid-norecords-cell, .sui-detail-cell, .sui-group-header-cell").each(function(){x(this).hasClass("sui-group-header-cell")?x(this).attr("colspan",e+i-f(x(this).parent().attr("data-group-level"))+1):x(this).attr("colspan",e)})},_getVisibleColumnFields:function(){for(var e=this.columns||[],t=e.length,i=[],n=0;n<t;n++)e[n].visible&&i.push(e[n].field);return i},_initFrozenCols:function(){for(var e=this.columns,t=e.length,i=!1,n=0;n<t;n++)if(e[n].locked){i=!0;break}if(i)for(this._initFrozenContainers(),n=0;n<t;n++)e[n].locked&&this.lockColumn(e[n].field)},_initFrozenContainers:function(){var e=this,t=e.options,i=t.scrolling;e.frozenHeaderWrapper||(e.frozenHeaderWrapper=x('<div class="sui-header-locked"/>').prependTo(i?e.headerWrapper.parent():e.headerWrapper),e.frozenHeaderTable=x('<table class="sui-table sui-non-selectable"'+(E?' cellspacing="0"':"")+'><colgroup/><thead><tr class="sui-columnheader"/>'+(t.filtering&&t.filtering.enabled?'<tr class="sui-filter-row"/>':"")+'</thead><tbody class="sui-hide"/></table>').appendTo(e.frozenHeaderWrapper)),e.frozenContentWrapper||(e.frozenContentWrapper=x('<div class="sui-content-locked"/>').prependTo(i?e.contentWrapper.parent():e.contentWrapper),e.frozenContentWrapper.height(e.frozenContentWrapper.parent().find(".sui-content").first().height()),e.frozenContentTable=x('<table class="sui-table'+(t.rowHover?" sui-hover":"")+'"'+(E?' cellspacing="0"':"")+'><colgroup/><tbody/><tfoot><tr class="sui-grid-footer"/></tfoot></table>').appendTo(e.frozenContentWrapper),e._hasDetailTemplate()&&(e._canExpandCollapse()&&e.frozenContentTable.addClass("sui-expandable"),e.frozenContentTable.on(H+e._eventNS,"> tbody > tr > .sui-expand-cell, > tbody > tr > .sui-collapse-cell",N(e._expandCollapseDetailTemplate,e))))},_destroyFrozenContainers:function(){var e=this;e.frozenHeaderWrapper&&(x(e.frozenHeaderWrapper).remove(),e.frozenHeaderWrapper=null),e.frozenContentWrapper&&(x(e.frozenContentWrapper).find(".sui-table").off(e._eventNS),x(e.frozenContentWrapper).remove(),e.frozenContentWrapper=null)},isLocked:function(e){e=this._getColumnByField(e);return e?e.locked:C},lockColumn:function(t){var e,i=this,n=x(i.element),r=i.options.filtering,o=i._getColumnByField(t),l=-1,a=i._footer;if(o&&o.visible){if(x(i.headerTable).find("colgroup").first().find("col").each(function(){if(x(this).data(G)==t)return x(this).appendTo(x(i.frozenHeaderTable).find("colgroup")),!1}),x(i.contentTable).find("colgroup").first().find("col").each(function(){if(x(this).data(G)==t)return x(this).appendTo(x(i.frozenContentTable).find("colgroup")),!1}),x(i.headerTable).find(".sui-columnheader").children().each(function(e){if(x(this).attr("data-field")==t)return l=e,x(this).appendTo(x(i.frozenHeaderTable).find(".sui-columnheader")),!1}),r&&r.enabled&&0<=l&&x(i.headerTable).find(".sui-filter-row").children().each(function(e){if(x(this).attr("data-field")==t)return x(this).appendTo(x(i.frozenHeaderTable).find(".sui-filter-row")),!1}),a&&0<=l&&(r=x(i.frozenContentTable).find("> tfoot > .sui-grid-footer"),x(a).find(".sui-grid-footer td:eq("+l+")").appendTo(r)),0<=l){0===(e=0===(e=n.find("> .sui-gridcontent > table > tbody > tr")).length?n.find("> .sui-gridcontent > .sui-virtualized > table > tbody > tr"):e).length&&(e=n.find("> .sui-gridcontent > .sui-content > table > tbody > tr"));for(var s=x(i.frozenContentTable).find("tbody"),d=0<s.children().length,c=0;c<e.length;c++){var u=null,u=d?x(s).children()[c]:x(e[c]).clone(!0,!1).empty().appendTo(s);x(e[c].cells[l]).appendTo(u)}}o.locked=!0,i._adjustWidthsLocked(),i._adjustHeightsLocked()}},unlockColumn:function(e){var i,n,r,t,o,l,a=this,s=(x(a.element),a.options.filtering),d=a.columns,c=a._footer,u=a._getColumnByField(e),p=-1,h=-1;if(u&&u.visible){for(x(a.frozenHeaderTable).find("colgroup").first().children().each(function(){if(x(this).data(G)==e)return i=x(this),p=x(this).index(),!1}),x(a.frozenContentTable).find("colgroup").first().children().each(function(){if(x(this).data(G)==e)return n=x(this),h=x(this).index(),!1}),t=0;t<d.length;t++)if(d[t].field===e){t<=d.length-2&&(r=d[t+1].field);break}r?(x(a.headerTable).find("> colgroup col").each(function(e){var t;if(x(this).data(G)===r)return x(i).insertBefore(x(this)),x(a.frozenHeaderTable).find(".sui-columnheader th:eq("+p+")").insertBefore(x(a.headerTable).find(".sui-columnheader th:eq("+e+")")),s&&s.enabled&&x(a.frozenHeaderTable).find(".sui-filter-row th:eq("+p+")").insertBefore(x(a.headerTable).find(".sui-filter-row th:eq("+e+")")),c&&(t=x(a.frozenContentTable).find("> tfoot > .sui-grid-footer"),x(t).find("td:eq("+p+")").insertBefore(x(c).find(".sui-grid-footer td:eq("+e+")"))),!1}),x(a.contentTable).find("> colgroup col").each(function(t){var i;if(x(this).data(G)===r)return x(n).insertBefore(x(this)),i=x(a.contentTable).find(">tbody").first().children(),x(a.frozenContentTable).find(">tbody > tr").each(function(e){x(this).find("td:eq("+h+")").insertBefore(x(i[e]).find("td:eq("+t+")"))}),!1})):(x(a.headerTable).find("colgroup").append(i),x(a.contentTable).find("colgroup").append(n),x(a.frozenHeaderTable).find(".sui-columnheader th:eq("+p+")").appendTo(x(a.headerTable).find(".sui-columnheader")),s&&s.enabled&&x(a.frozenHeaderTable).find(".sui-filter-row th:eq("+p+")").appendTo(x(a.headerTable).find(".sui-filter-row")),c&&(o=x(a.frozenContentTable).find("> tfoot > .sui-grid-footer"),x(o).find("td:eq("+p+")").appendTo(x(c).find(".sui-grid-footer"))),l=x(a.contentTable).find(">tbody").first().children(),x(a.frozenContentTable).find(">tbody > tr").each(function(e){x(this).find("td:eq("+h+")").appendTo(x(l[e]))})),u.locked=!1,a._adjustWidthsLocked(),a._adjustHeightsLocked()}},_adjustWidthsLocked:function(){var e=this;e.frozenHeaderWrapper&&(x(e.headerWrapper).parent().css(g.isRtl(e.element)?"padding-left":"padding-right",0),x(e.headerWrapper).outerWidth(x(e.headerWrapper).parent().innerWidth()-x(e.frozenHeaderWrapper).outerWidth()-g.scrollbar()),x(e.contentWrapper).outerWidth(x(e.contentWrapper).parent().innerWidth()-x(e.frozenContentWrapper).outerWidth()-1))},_adjustHeightsLocked:function(e){var t,i,n,r,o,l,a,s,d,c=this,u=c.options.filtering,p=c._footer;if(c.frozenHeaderWrapper){for((a=x(c.frozenHeaderTable).find("tr").first()).height("auto"),s=f(a.height()),(d=x(c.headerTable).find("tr").first()).height("auto"),(o=f(d.height()))<s?(a.height(s),d.height(s)):s<o&&(a.height(o),d.height(o)),u&&u.enabled&&((s=x(c.frozenHeaderTable).find("tr.sui-filter-row").first()).height("auto"),a=f(s.height()),(d=x(c.headerTable).find("tr.sui-filter-row").first()).height("auto"),(o=f(d.height()))<a?(s.height(a),d.height(a)):a<o&&(s.height(o),d.height(o))),t=x(c.frozenContentTable).find("tbody").first().children(),n=x(c.contentTable).find("> tbody").children(),l=0;l<n.length;l++)x(t[l]).height("auto"),i=f(x(t[l]).height()),x(n[l]).height("auto"),(r=f(x(n[l]).height()))<i?(x(t[l]).height(i),x(n[l]).height(i)):i<r&&(x(t[l]).height(r),x(n[l]).height(r));p&&(u=x(c.frozenContentTable).find("> tfoot > .sui-grid-footer"),a=x(p).find(".sui-grid-footer").first(),u.height("auto"),s=f(u.height()),a.height("auto"),(d=f(a.height()))<s?(u.height(s),a.height(s)):s<d&&(u.height(d),a.height(d))),e&&c._initScrolling()}},_getOtherRow:function(e){var t,i,n;if(this.frozenHeaderWrapper){if(t=x(e).index(),i=x(this.frozenContentTable).find("tbody").first().children(),n=x(this.contentTable).find("> tbody").children(),x(e)[0]===x(i)[t])return x(n)[t];if(x(e)[0]===x(n)[t])return x(i)[t]}return null},exportExcel:function(){this._doExcelExport()},exportPdf:function(){this._doPdfExport()},exportCsv:function(){this._doCsvExport()},_doExcelExport:function(){var u,p,h,f,g,_,e,t,m=this,i=m.options,v=[],b=[];w&&!(e=m.trigger(z,{commandName:"exportExcel",cancel:!1,exportOptions:R(!0,{},i.exportOptions)})).cancel&&(m.loading(!0,!0),setTimeout(function(){u=R(!0,{proxy:C,excel:{fileName:"Untitled",fileFormat:"xlsx",noLegacyFallback:!1,author:C,created:new Date,producer:C,dataSource:C,readDataSource:!1,columnFields:C,header:{enabled:!0,style:{bold:!0},cells:C},worksheet:{name:"Sheet1",columns:C},worksheets:[],worksheetIndex:0}},e.exportOptions),p=u.excel,g=(g=p.columnFields)||m._getVisibleColumnFields(),_=g.length,p.worksheet.columns||(p.worksheet.columns=L(g,function(e){return{autoWidth:!0}})),f=R(!0,{},p.worksheet),p.header&&p.header.enabled&&(p.header.cells?b.push({cells:p.header.cells}):b.push({cells:L(g,function(e){var t=m._getColumnByField(e);return{type:String,value:I(t)&&t.title?t.title:e,style:p.header.style}})})),h=M.create(p.dataSource||m.dataSource),t=function(){for(var e,t,i=h.view||[],n=i.length,r=[],o=0;o<_;o++)r[o]=y(h,"schema.options.fields."+g[o]+".type");for(o=0;o<n;o++){var l,a,s=i[o],d=m.trigger(z,{commandName:"exportExcelRow",cancel:!1,item:s,index:o,row:{}}),c=[];if(!d.cancel){for(l=R(!0,{},d.row),t=0;t<_;t++)a={type:I(l.type)?l.type:r[t],value:I(l.value)?l.value:y(s,g[t])},l.cells&&l.cells[t]&&R(!0,a,l.cells[t]),c.push(a);b.push({index:l.index,height:l.height,cells:c})}}f.rows=b,(v=[].slice.call(p.worksheets)).splice(p.worksheetIndex,0,f),e={created:p.created,author:p.author,worksheets:v},new("xml"==p.fileFormat?w.ExcelXMLSpreadsheet:w.OOXMLWorkbook)(e).saveAs({fileName:p.fileName,forceExt:u.forceExt,proxy:u.proxy}),m.loading(!1)},p.readDataSource?h.read().always(t):t()},100))},_doPdfExport:function(){var s,d,c,e,t,u,p,h=this,i=h.options;w&&!(e=h.trigger(z,{commandName:"exportPdf",cancel:!1,exportOptions:R(!0,{},i.exportOptions)})).cancel&&(h.loading(!0,!0),setTimeout(function(){s=R(!0,{proxy:C,pdf:{fileName:"Untitled",author:C,created:new Date,size:"a4",orientation:"portrait",fontSize:10,dataSource:C,readDataSource:!1,columnFields:C,header:{enabled:!0,cells:C},margins:{left:72,top:72,bottom:72,right:72}}},e.exportOptions),d=s.pdf,t=(t=d.columnFields)||h._getVisibleColumnFields(),t.length,d.header&&(p=!!d.header.enabled,d.header.cells&&(u=[].concat(d.header.cells))),I(p)||(p=!0),I(u)||(u=L(t,function(e){var t=h._getColumnByField(e);return{field:e,title:t.title||e,width:t.width||C}})),c=M.create(d.dataSource||h.dataSource),t=function(){for(var e,t,i,n=c.view||[],r=n.length,o=[],l=d.margins,a=0;a<r;a++)e=n[a],(t=h.trigger(z,{commandName:"exportPdfRow",cancel:!1,item:e,index:a,row:{}})).cancel||o.push(R(!0,e,t.row));(i=new w.PDFDocument({author:d.author,created:d.created})).addPage(d.size,d.orientation),i.table(l.left,l.top,o,u,{margins:l,printHeader:p,fontSize:d.fontSize}),i.saveAs({fileName:d.fileName,forceExt:s.forceExt,proxy:s.proxy}),h.loading(!1)},d.readDataSource?c.read().always(t):t()},100))},_doCsvExport:function(){var c,u,p,e,t,h,f,g=this,i=g.options;w&&!(e=g.trigger(z,{commandName:"exportCsv",cancel:!1,exportOptions:R(!0,{},i.exportOptions)})).cancel&&(g.loading(!0,!0),setTimeout(function(){c=R(!0,{proxy:C,csv:{fileName:"Untitled",delimiter:",",dataSource:C,readDataSource:!1,columnFields:C,header:{enabled:!0,cells:C}}},e.exportOptions),u=c.csv,t=(t=u.columnFields)||g._getVisibleColumnFields(),t.length,u.header&&(f=!!u.header.enabled,u.header.cells&&(h=[].concat(u.header.cells))),I(f)||(f=!0),I(h)||(h=L(t,function(e){return{field:e,title:g._getColumnByField(e).title||e}})),p=M.create(u.dataSource||g.dataSource),t=function(){var e,t,i,n,r,o=p.view||[],l=o.length,a=h.length,s=[],d=[];for(f&&(s=L(h,function(e){return e.title})),e=0;e<l;e++)if(i=o[e],!(r=g.trigger(z,{commandName:"exportCsvRow",cancel:!1,item:i,index:e,row:n})).cancel){if((r=R(!0,{},r.row))&&r.cells)n=r.cells;else for(n=[],t=0;t<a;t++)n.push(y(i,h[t].field));d.push(n)}new w.CSVDocument({delimiter:u.delimiter,printHeader:f,header:s,records:d}).saveAs({fileName:u.fileName,forceExt:c.forceExt,proxy:c.proxy}),g.loading(!1)},u.readDataSource?p.read().always(t):t()},100))}});i.defaults=j,_.ui.plugin("Grid",i)}(jQuery,shield,this);